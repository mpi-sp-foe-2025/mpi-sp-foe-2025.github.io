<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>StaticIFC: Information Flow Control Type Systems</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/secf.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 7: Security Foundations</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">StaticIFC<span class="subtitle">Information Flow Control Type Systems</span></h1>


<div class="code">

<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-parsing,-deprecated-hint-without-locality".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#"><span class="id" title="library">Strings.String</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">SECF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">Maps</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#"><span class="id" title="library">Bool.Bool</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Arith.html#"><span class="id" title="library">Arith.Arith</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.EqNat.html#"><span class="id" title="library">Arith.EqNat</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#"><span class="id" title="library">Arith.PeanoNat</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat"><span class="id" title="module">Nat</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">SECF</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">Imp</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#"><span class="id" title="library">List</span></a>. <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ListNotations"><span class="id" title="module">ListNotations</span></a>.<br/>
<span class="id" title="keyword">Set</span> <span class="id" title="var">Default</span> <span class="id" title="keyword">Goal</span> <span class="id" title="var">Selector</span> "!".<br/>
</div>

<div class="doc">
<a id="lab28"></a><h1 class="section">Noninterference</h1>

<div class="paragraph"> </div>

 As explained in the <a href="Noninterference.html"><span class="inlineref">Noninterference</span></a> chapter, data
    confidentiality is most often expressed formally as a property
    called <i>noninterference</i>.

<div class="paragraph"> </div>

    To formalize this for Imp programs, we divide the variables as
    either public or secret by assuming a total map <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">:</span> <span class="inlinecode"><span class="id" title="var">pub_vars</span></span>
    between variables and Boolean labels: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="label" class="idref" href="#label"><span class="id" title="definition">label</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="public" class="idref" href="#public"><span class="id" title="definition">public</span></a> : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> := <span class="id" title="notation">true</span>.<br/>
<span class="id" title="keyword">Definition</span> <a id="secret" class="idref" href="#secret"><span class="id" title="definition">secret</span></a> : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> := <span class="id" title="notation">false</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="pub_vars" class="idref" href="#pub_vars"><span class="id" title="definition">pub_vars</span></a> := <span class="id" title="definition">total_map</span> <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a>.<br/>
</div>

<div class="doc">
A noninterference attacker can only observe the final values of public
    variables, not of secret ones. We formalize this as a notion of
    <i>publicly equivalent states</i> that agree on the values of all
    public variables, which are thus indistinguishable to an attacker: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="pub_equiv" class="idref" href="#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> (<a id="P:1" class="idref" href="#P:1"><span class="id" title="binder">P</span></a> : <a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) {<a id="X:2" class="idref" href="#X:2"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>} (<a id="s<sub>1</sub>:3" class="idref" href="#s<sub>1</sub>:3"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:4" class="idref" href="#s<sub>2</sub>:4"><span class="id" title="binder">s<sub>2</sub></span></a> : <span class="id" title="definition">total_map</span> <a class="idref" href="StaticIFC.html#X:2"><span class="id" title="variable">X</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="x:5" class="idref" href="#x:5"><span class="id" title="binder">x</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>, <a class="idref" href="StaticIFC.html#P:1"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#x:5"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:3"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#x:5"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:4"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#x:5"><span class="id" title="variable">x</span></a>.<br/>
</div>

<div class="doc">
For some total map <span class="inlinecode"><span class="id" title="var">P</span></span> from variables to Boolean labels,
    <span class="inlinecode"><span class="id" title="var">pub_equiv</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> is an equivalence relation on states, so reflexive,
    symmetric, and transitive. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="pub_equiv_refl" class="idref" href="#pub_equiv_refl"><span class="id" title="lemma">pub_equiv_refl</span></a> : <span class="id" title="keyword">∀</span> {<a id="X:6" class="idref" href="#X:6"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>} (<a id="P:7" class="idref" href="#P:7"><span class="id" title="binder">P</span></a> : <a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) (<a id="s:8" class="idref" href="#s:8"><span class="id" title="binder">s</span></a> : <span class="id" title="definition">total_map</span> <a class="idref" href="StaticIFC.html#X:6"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:7"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s:8"><span class="id" title="variable">s</span></a> <a class="idref" href="StaticIFC.html#s:8"><span class="id" title="variable">s</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">P</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="pub_equiv_sym" class="idref" href="#pub_equiv_sym"><span class="id" title="lemma">pub_equiv_sym</span></a> : <span class="id" title="keyword">∀</span> {<a id="X:9" class="idref" href="#X:9"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>} (<a id="P:10" class="idref" href="#P:10"><span class="id" title="binder">P</span></a> : <a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) (<a id="s<sub>1</sub>:11" class="idref" href="#s<sub>1</sub>:11"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:12" class="idref" href="#s<sub>2</sub>:12"><span class="id" title="binder">s<sub>2</sub></span></a> : <span class="id" title="definition">total_map</span> <a class="idref" href="StaticIFC.html#X:9"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:10"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:11"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:12"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:10"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:12"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:11"><span class="id" title="variable">s<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">P</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">Px</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="pub_equiv_trans" class="idref" href="#pub_equiv_trans"><span class="id" title="lemma">pub_equiv_trans</span></a> : <span class="id" title="keyword">∀</span> {<a id="X:13" class="idref" href="#X:13"><span class="id" title="binder">X</span></a>:<span class="id" title="keyword">Type</span>} (<a id="P:14" class="idref" href="#P:14"><span class="id" title="binder">P</span></a> : <a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) (<a id="s<sub>1</sub>:15" class="idref" href="#s<sub>1</sub>:15"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:16" class="idref" href="#s<sub>2</sub>:16"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>3</sub>:17" class="idref" href="#s<sub>3</sub>:17"><span class="id" title="binder">s<sub>3</sub></span></a> : <span class="id" title="definition">total_map</span> <a class="idref" href="StaticIFC.html#X:13"><span class="id" title="variable">X</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:14"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:15"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:16"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:14"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:16"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>3</sub>:17"><span class="id" title="variable">s<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:14"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:15"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>3</sub>:17"><span class="id" title="variable">s<sub>3</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a>. <span class="id" title="tactic">intros</span> <span class="id" title="var">X</span> <span class="id" title="var">P</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>3</sub></span> <span class="id" title="var">H<sub>12</sub></span> <span class="id" title="var">H<sub>23</sub></span> <span class="id" title="var">x</span> <span class="id" title="var">Px</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H<sub>12</sub></span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H<sub>23</sub></span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Program <span class="inlinecode"><span class="id" title="var">c</span></span> is <i>noninterferent</i> if whenever it has two terminating
    runs from two publicly equivalent initial states <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> and <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>,
    the obtained final states <span class="inlinecode"><span class="id" title="var">s<sub>1</sub>'</span></span> and <span class="inlinecode"><span class="id" title="var">s<sub>2</sub>'</span></span> are also publicly equivalent. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="noninterferent" class="idref" href="#noninterferent"><span class="id" title="definition">noninterferent</span></a> <a id="P:18" class="idref" href="#P:18"><span class="id" title="binder">P</span></a> <a id="c:19" class="idref" href="#c:19"><span class="id" title="binder">c</span></a> := <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:20" class="idref" href="#s<sub>1</sub>:20"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:21" class="idref" href="#s<sub>2</sub>:21"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>1</sub>':22" class="idref" href="#s<sub>1</sub>':22"><span class="id" title="binder">s<sub>1</sub>'</span></a> <a id="s<sub>2</sub>':23" class="idref" href="#s<sub>2</sub>':23"><span class="id" title="binder">s<sub>2</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:18"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:20"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:21"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s<sub>1</sub>:20"><span class="id" title="variable">s<sub>1</sub></span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:19"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s<sub>1</sub>':22"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s<sub>2</sub>:21"><span class="id" title="variable">s<sub>2</sub></span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:19"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s<sub>2</sub>':23"><span class="id" title="variable">s<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:18"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>':22"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>':23"><span class="id" title="variable">s<sub>2</sub>'</span></a>.<br/>
</div>

<div class="doc">
Intuitively, <span class="inlinecode"><span class="id" title="var">c</span></span> is noninterferent when the value of the public
    variables in the final state can only depend on the value of
    public variables in the initial state, and do not depend on the
    initial value of secret variables.

<div class="paragraph"> </div>

    In particular, changing the value of the secret variables in the
    initial state (as allowed by <span class="inlinecode"><span class="id" title="var">pub_equiv</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span>), should lead to
    no change in the final value of the public variables (as required
    by <span class="inlinecode"><span class="id" title="var">pub_equiv</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>1</sub>'</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub>'</span></span>). 
<div class="paragraph"> </div>

 For instance, consider the following command
    (taken from <a href="Noninterference.html"><span class="inlineref">Noninterference</span></a>): 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="secure_com" class="idref" href="#secure_com"><span class="id" title="definition">secure_com</span></a> : <span class="id" title="inductive">com</span> := <span class="id" title="notation">&lt;{</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span>1<span class="id" title="notation">;</span> <span class="id" title="definition">Y</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span><span class="id" title="definition">Y</span><span class="id" title="notation">×</span>2 <span class="id" title="notation">}&gt;</span>.<br/>
</div>

<div class="doc">
If we assume that variable <span class="inlinecode"><span class="id" title="var">X</span></span> is public and variable <span class="inlinecode"><span class="id" title="var">Y</span></span> is
    secret, we can state noninterference for <span class="inlinecode"><span class="id" title="var">secure_com</span></span> as follows: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="xpub" class="idref" href="#xpub"><span class="id" title="definition">xpub</span></a> : <a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a> := (<span class="id" title="definition">X</span> <span class="id" title="notation">!<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">_</span> <span class="id" title="notation">!<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="noninterferent_secure_com" class="idref" href="#noninterferent_secure_com"><span class="id" title="definition">noninterferent_secure_com</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a> <a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#secure_com"><span class="id" title="definition">secure_com</span></a>.<br/>
</div>

<div class="doc">
We have already proved that <span class="inlinecode"><span class="id" title="var">secure_com</span></span> is indeed noninterferent
    both directly using the semantics (in <a href="Noninterference.html"><span class="inlineref">Noninterference</span></a>).
    This proof was manual though, while in this chapter we will show
    how this proof can be done more syntactically and automatically
    using several <i>information flow control</i> (IFC) type systems that
    enforce noninterference for all well-typed programs. 
<div class="paragraph"> </div>

 Not all programs are noninterferent though. For instance, a
    program that reads the contents of a secret variable and uses that
    to change the value of a public variable is unlikely to be
    noninterferent. We call this an <i>explicit flow</i> and all our type
    systems will prevent <i>all</i> explicit flows.

<div class="paragraph"> </div>

    Here is a program that has an explicit flow, which in this case
    breaks noninterference (as we proved in <a href="Noninterference.html"><span class="inlineref">Noninterference</span></a>): 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="insecure_com1" class="idref" href="#insecure_com1"><span class="id" title="definition">insecure_com1</span></a> : <span class="id" title="inductive">com</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">&lt;{</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">Y</span><span class="id" title="notation">+</span>1<span class="id" title="notation">;</span> <span class="comment">(*&nbsp;&lt;-&nbsp;bad&nbsp;explicit&nbsp;flow!&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Y</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span><span class="id" title="definition">Y</span><span class="id" title="notation">×</span>2 <span class="id" title="notation">}&gt;</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Definition</span> <a id="interferent_insecure_com1" class="idref" href="#interferent_insecure_com1"><span class="id" title="definition">interferent_insecure_com1</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a><a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a> <a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#insecure_com1"><span class="id" title="definition">insecure_com1</span></a>.<br/>
</div>

<div class="doc">
Not all explicit flows break noninterference though. For instance,
    the following variant of <span class="inlinecode"><span class="id" title="var">insecure_com1</span></span> is noninterferent even if
    it has an explicit flow. The reason for this is that the variable
    <span class="inlinecode"><span class="id" title="var">X</span></span> is overwritten with public information in a subsequent assignment. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="secure_com1'" class="idref" href="#secure_com1'"><span class="id" title="definition">secure_com1'</span></a> : <span class="id" title="inductive">com</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">&lt;{</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">Y</span><span class="id" title="notation">+</span>1<span class="id" title="notation">;</span> <span class="comment">(*&nbsp;&lt;-&nbsp;harmless&nbsp;explicit&nbsp;flow&nbsp;(dead&nbsp;store)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> 42<span class="id" title="notation">;</span> <span class="comment">(*&nbsp;&lt;-&nbsp;X&nbsp;is&nbsp;overwritten&nbsp;afterwards&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Y</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span><span class="id" title="definition">Y</span><span class="id" title="notation">×</span>2 <span class="id" title="notation">}&gt;</span>.<br/>
</div>

<div class="doc">
Since our IFC type systems will prevent all explicit flows, they
    will also reject <span class="inlinecode"><span class="id" title="var">secure_com1'</span></span>, even if it is secure with respect
    to our simple attacker model for noninterference, in which the
    attacker only observes the <i>final</i> values of public variables.

<div class="paragraph"> </div>

    Our type systems will only provide <i>sound syntactic
    overapproximations</i> of the semantic noninterference property. 
<div class="paragraph"> </div>

 Explicit flows are not the only way to leak secrets: one can also
    leak secrets using the control flow of the program, by branching
    on secrets and then assigning to public variables. We call these
    leaks <i>implicit flows</i>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="insecure_com2" class="idref" href="#insecure_com2"><span class="id" title="definition">insecure_com2</span></a> : <span class="id" title="inductive">com</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="definition">Y</span> <span class="id" title="notation">=</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">then</span> <span class="id" title="definition">Y</span> <span class="id" title="notation">:=</span> 42<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">else</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span>1 <span class="comment">(*&nbsp;&lt;-&nbsp;bad&nbsp;implicit&nbsp;flow!&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span>.<br/>
</div>

<div class="doc">
Here the expression <span class="inlinecode"><span class="id" title="var">X</span>+1</span> we are assigning to <span class="inlinecode"><span class="id" title="var">X</span></span> is public
    information, but we are doing this assignment after we branched on
    a secret condition <span class="inlinecode"><span class="id" title="var">Y</span></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span>, so we are indirectly leaking
    information about the value of <span class="inlinecode"><span class="id" title="var">Y</span></span>. In this case we can infer that
    if <span class="inlinecode"><span class="id" title="var">X</span></span> gets incremented the value of <span class="inlinecode"><span class="id" title="var">Y</span></span> is not <span class="inlinecode">0</span>. This program
    is insecure (as proved in <a href="Noninterference.html"><span class="inlineref">Noninterference</span></a>), so it will be
    rejected by our type systems, which enforce noninterference by
    also preventing <i>all</i> implicit flows. 
<div class="paragraph"> </div>

 Not all implicit flows break noninterference though. Here is a
    program that is noninterferent, even though it contains both an
    explicit and an implicit flow: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="secure_p<sub>2</sub>" class="idref" href="#secure_p<sub>2</sub>"><span class="id" title="definition">secure_p<sub>2</sub></span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="definition">Y</span> <span class="id" title="notation">=</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">then</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">Y</span> <span class="comment">(*&nbsp;&lt;-&nbsp;harmless&nbsp;explicit&nbsp;flow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">else</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> 0 <span class="comment">(*&nbsp;&lt;-&nbsp;harmless&nbsp;implicit&nbsp;flow&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span>.<br/>
</div>

<div class="doc">
Intuitively, even if this program branches on the secret <span class="inlinecode"><span class="id" title="var">Y</span></span>, it
    always assigns the value <span class="inlinecode">0</span> to <span class="inlinecode"><span class="id" title="var">X</span></span>, so no secret is
    leaked. We can prove this semantically: 
</div>
<div class="code">
<hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="noninterference_secure_p<sub>2</sub>" class="idref" href="#noninterference_secure_p<sub>2</sub>"><span class="id" title="lemma">noninterference_secure_p<sub>2</sub></span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a> <a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#secure_p<sub>2</sub>"><span class="id" title="definition">secure_p<sub>2</sub></span></a>.<br/>
<div class="togglescript" id="proofcontrol1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')"><span class="show"></span></div>
<div class="proofscript" id="proof1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a>, <a class="idref" href="StaticIFC.html#secure_p<sub>2</sub>"><span class="id" title="definition">secure_p<sub>2</sub></span></a>, <a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">H</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span> <span class="id" title="var">x</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#xpub_true"><span class="id" title="lemma">xpub_true</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">invert</span> <span class="id" title="var">H<sub>1</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>8</sub></span>. <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>9</sub></span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="axiom">t_update_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert</span> <span class="id" title="var">H<sub>7</sub></span>. <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>6</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a> <span class="id" title="keyword">in</span> ×. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H<sub>1</sub></span>, <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>8</sub></span>. <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>9</sub></span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="axiom">t_update_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert</span> <span class="id" title="var">H<sub>7</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>8</sub></span>. <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>9</sub></span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="axiom">t_update_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">invert</span> <span class="id" title="var">H<sub>6</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>8</sub></span>. <span class="id" title="var">invert</span> <span class="id" title="var">H<sub>9</sub></span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="axiom">t_update_eq</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
Still, our type systems will reject programs containing
    any explicit or implicit flows, this one included. C'est la vie! 
<div class="paragraph"> </div>

<a id="lab29"></a><h1 class="section">Type system for noninterference of expressions</h1>

<div class="paragraph"> </div>

 We will build a type system that prevents all explicit and
    implicit flows.

<div class="paragraph"> </div>

    But first, let's start with something simpler, a type system for
    arithmetic expressions: our typing judgement <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">a</span>-</span> <span class="inlinecode"><span class="id" title="var">a</span></span> &#x2208; <span class="inlinecode"><span class="id" title="var">l</span></span>
    specifies the label <span class="inlinecode"><span class="id" title="var">l</span></span> of an arithmetic expression <span class="inlinecode"><span class="id" title="var">a</span></span> in terms
    of the labels of the variables read it reads.

<div class="paragraph"> </div>

    In particular, <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">a</span>-</span> <span class="inlinecode"><span class="id" title="var">a</span></span> &#x2208; <span class="inlinecode"><span class="id" title="var">public</span></span> says that expression <span class="inlinecode"><span class="id" title="var">a</span></span>
    only reads public variables, so it computes a public value.
    <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">a</span>-</span> <span class="inlinecode"><span class="id" title="var">a</span></span> &#x2208; <span class="inlinecode"><span class="id" title="var">secret</span></span> says that expression <span class="inlinecode"><span class="id" title="var">a</span></span> reads some secret
    variable, so it computes a value that may depend on secrets. 
<div class="paragraph"> </div>

 Here are some examples:
<ul class="doclist">
<li> For a variable <span class="inlinecode"><span class="id" title="var">X</span></span> we just look up its label in P, so
      <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">a</span>-</span> <span class="inlinecode"><span class="id" title="var">X</span></span> &#x2208; <span class="inlinecode">(<span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">X</span>)</span>.

</li>
<li> For a constant <span class="inlinecode"><span class="id" title="var">n</span></span> the label is <span class="inlinecode"><span class="id" title="var">public</span></span>, so
      <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="var">n</span></span> &#x2208; <span class="inlinecode"><span class="id" title="var">public</span></span>.

</li>
<li> Given variable <span class="inlinecode"><span class="id" title="var">X<sub>1</sub></span></span> with label <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> and variable <span class="inlinecode"><span class="id" title="var">X<sub>2</sub></span></span> with
      label <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span>, what should be the label of <span class="inlinecode"><span class="id" title="var">X<sub>1</sub></span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">X<sub>2</sub></span></span> though? 
</li>
</ul>

<div class="paragraph"> </div>

<a id="lab30"></a><h2 class="section">Combining labels</h2>

<div class="paragraph"> </div>

 We need a way to combine the labels of two sub-expressions, which
    we call the <i>join</i> (or least upper bound) of the two labels: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="join" class="idref" href="#join"><span class="id" title="definition">join</span></a> (<a id="l<sub>1</sub>:25" class="idref" href="#l<sub>1</sub>:25"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:26" class="idref" href="#l<sub>2</sub>:26"><span class="id" title="binder">l<sub>2</sub></span></a> : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a>) : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> := <a class="idref" href="StaticIFC.html#l<sub>1</sub>:25"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:26"><span class="id" title="variable">l<sub>2</sub></span></a>.<br/>
</div>

<div class="doc">
Intuitively, if we add up two expressions <span class="inlinecode"><span class="id" title="var">e<sub>1</sub></span></span> labeled <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> and
    <span class="inlinecode"><span class="id" title="var">e<sub>2</sub></span></span> labeled <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span>, the result of the addition will be labeled
    <span class="inlinecode"><span class="id" title="var">join</span></span> <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span>, which is public iff <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> is public <i>and</i> <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span> is public. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="join_commutative" class="idref" href="#join_commutative"><span class="id" title="lemma">join_commutative</span></a> : <span class="id" title="keyword">∀</span> {<a id="l<sub>1</sub>:27" class="idref" href="#l<sub>1</sub>:27"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:28" class="idref" href="#l<sub>2</sub>:28"><span class="id" title="binder">l<sub>2</sub></span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:27"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:28"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:28"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:27"><span class="id" title="variable">l<sub>1</sub></span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l<sub>1</sub></span> <span class="id" title="var">l<sub>2</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>1</sub></span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>2</sub></span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="join_public" class="idref" href="#join_public"><span class="id" title="lemma">join_public</span></a> : <span class="id" title="keyword">∀</span> {<a id="l<sub>1</sub>:29" class="idref" href="#l<sub>1</sub>:29"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:30" class="idref" href="#l<sub>2</sub>:30"><span class="id" title="binder">l<sub>2</sub></span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:29"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:30"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:29"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:30"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#andb_prop"><span class="id" title="lemma">andb_prop</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="join_public_l" class="idref" href="#join_public_l"><span class="id" title="lemma">join_public_l</span></a> : <span class="id" title="keyword">∀</span> {<a id="l:31" class="idref" href="#l:31"><span class="id" title="binder">l</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#l:31"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#l:31"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="join_public_r" class="idref" href="#join_public_r"><span class="id" title="lemma">join_public_r</span></a> : <span class="id" title="keyword">∀</span> {<a id="l:32" class="idref" href="#l:32"><span class="id" title="binder">l</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l:32"><span class="id" title="variable">l</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#l:32"><span class="id" title="variable">l</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="StaticIFC.html#join_commutative"><span class="id" title="lemma">join_commutative</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="join_secret_l" class="idref" href="#join_secret_l"><span class="id" title="lemma">join_secret_l</span></a> : <span class="id" title="keyword">∀</span> {<a id="l:33" class="idref" href="#l:33"><span class="id" title="binder">l</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="StaticIFC.html#l:33"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="join_secret_r" class="idref" href="#join_secret_r"><span class="id" title="lemma">join_secret_r</span></a> : <span class="id" title="keyword">∀</span> {<a id="l:34" class="idref" href="#l:34"><span class="id" title="binder">l</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l:34"><span class="id" title="variable">l</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="StaticIFC.html#join_commutative"><span class="id" title="lemma">join_commutative</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
We now define a set of rules for the IFC typing relation for
    arithmetic expressions <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">a</span>-</span> <span class="inlinecode"><span class="id" title="var">a</span></span> &#x2208; <span class="inlinecode"><span class="id" title="var">l</span></span>, which we read as follows:
    "given the public variables <span class="inlinecode"><span class="id" title="var">P</span></span> expression <span class="inlinecode"><span class="id" title="var">a</span></span> has label <span class="inlinecode"><span class="id" title="var">l</span></span>:" 
<div class="paragraph"> </div>

 <center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (T_Num) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- n &#x2208; public</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (T_Id) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- X &#x2208; P X</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a<sub>1</sub> &#x2208; l<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;a- a<sub>2</sub> &#x2208; l<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (T_Plus) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a<sub>1</sub>+a<sub>2</sub> &#x2208; join l<sub>1</sub> l<sub>2</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a<sub>1</sub> &#x2208; l<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;a- a<sub>2</sub> &#x2208; l<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (T_Minus) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a<sub>1</sub>-a<sub>2</sub> &#x2208; join l<sub>1</sub> l<sub>2</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a<sub>1</sub> &#x2208; l<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;a- a<sub>2</sub> &#x2208; l<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (T_Mult) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a<sub>1</sub>*a<sub>2</sub> &#x2208; join l<sub>1</sub> l<sub>2</sub></td>
  <td></td>
</tr>
</table></center>
</div>
<div class="code">

<span class="id" title="keyword">Reserved Notation</span> &quot;P '&#x22A2;a-' a &#x2208; l" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Inductive</span> <a id="aexp_has_label" class="idref" href="#aexp_has_label"><span class="id" title="definition, inductive"><span id="aexp_has_label_ind" class="id"><span id="aexp_has_label_sind" class="id">aexp_has_label</span></span></span></a> (<a id="P:35" class="idref" href="#P:35"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) : <span class="id" title="inductive">aexp</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="T_Num" class="idref" href="#T_Num"><span class="id" title="constructor">T_Num</span></a> : <span class="id" title="keyword">∀</span> <a id="n:38" class="idref" href="#n:38"><span class="id" title="binder">n</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">(</span></a><span class="id" title="constructor">ANum</span> <a class="idref" href="StaticIFC.html#n:38"><span class="id" title="variable">n</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a><br/>
&nbsp;&nbsp;| <a id="T_Id" class="idref" href="#T_Id"><span class="id" title="constructor">T_Id</span></a> : <span class="id" title="keyword">∀</span> <a id="X:39" class="idref" href="#X:39"><span class="id" title="binder">X</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">(</span></a><span class="id" title="constructor">AId</span> <a class="idref" href="StaticIFC.html#X:39"><span class="id" title="variable">X</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#X:39"><span class="id" title="variable">X</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="T_Plus" class="idref" href="#T_Plus"><span class="id" title="constructor">T_Plus</span></a> : <span class="id" title="keyword">∀</span> <a id="a<sub>1</sub>:40" class="idref" href="#a<sub>1</sub>:40"><span class="id" title="binder">a<sub>1</sub></span></a> <a id="l<sub>1</sub>:41" class="idref" href="#l<sub>1</sub>:41"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="a<sub>2</sub>:42" class="idref" href="#a<sub>2</sub>:42"><span class="id" title="binder">a<sub>2</sub></span></a> <a id="l<sub>2</sub>:43" class="idref" href="#l<sub>2</sub>:43"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:40"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:41"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:42"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:43"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:40"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="notation">+</span> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:42"><span class="id" title="variable">a<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:41"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:43"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="T_Minus" class="idref" href="#T_Minus"><span class="id" title="constructor">T_Minus</span></a> : <span class="id" title="keyword">∀</span> <a id="a<sub>1</sub>:44" class="idref" href="#a<sub>1</sub>:44"><span class="id" title="binder">a<sub>1</sub></span></a> <a id="l<sub>1</sub>:45" class="idref" href="#l<sub>1</sub>:45"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="a<sub>2</sub>:46" class="idref" href="#a<sub>2</sub>:46"><span class="id" title="binder">a<sub>2</sub></span></a> <a id="l<sub>2</sub>:47" class="idref" href="#l<sub>2</sub>:47"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:44"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:45"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:46"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:47"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:44"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="notation">-</span> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:46"><span class="id" title="variable">a<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:45"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:47"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="T_Mult" class="idref" href="#T_Mult"><span class="id" title="constructor">T_Mult</span></a> : <span class="id" title="keyword">∀</span> <a id="a<sub>1</sub>:48" class="idref" href="#a<sub>1</sub>:48"><span class="id" title="binder">a<sub>1</sub></span></a> <a id="l<sub>1</sub>:49" class="idref" href="#l<sub>1</sub>:49"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="a<sub>2</sub>:50" class="idref" href="#a<sub>2</sub>:50"><span class="id" title="binder">a<sub>2</sub></span></a> <a id="l<sub>2</sub>:51" class="idref" href="#l<sub>2</sub>:51"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:48"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:49"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:50"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:51"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:35"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:48"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="notation">×</span> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:50"><span class="id" title="variable">a<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:49"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:51"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">)</span></a><br/>
<br/>
<span class="id" title="keyword">where</span> <a id="871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>" class="idref" href="#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&quot;</span></a>P '&#x22A2;a-' a '&#x2208;' l" := (<a class="idref" href="StaticIFC.html#aexp_has_label:37"><span class="id" title="inductive">aexp_has_label</span></a> <span class="id" title="var">P</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span>).<br/>
</div>

<div class="doc">
<a id="lab31"></a><h2 class="section">Computing labels of arithmetic expressions</h2>

<div class="paragraph"> </div>

 Beyond <i>specifying</i> when an expression has a certain label as an
    inductive relation, we can also easily <i>compute</i> the label of an
    expression: 
</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="label_of_aexp" class="idref" href="#label_of_aexp"><span class="id" title="definition">label_of_aexp</span></a> (<a id="P:52" class="idref" href="#P:52"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) (<a id="a:53" class="idref" href="#a:53"><span class="id" title="binder">a</span></a>:<span class="id" title="inductive">aexp</span>) : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="StaticIFC.html#a:53"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="constructor">ANum</span> <span class="id" title="var">n</span> ⇒ <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="constructor">AId</span> <span class="id" title="var">X</span> ⇒ <a class="idref" href="StaticIFC.html#P:52"><span class="id" title="variable">P</span></a> <span class="id" title="var">X</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="notation">+</span> <span class="id" title="var">a<sub>2</sub></span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="notation">-</span> <span class="id" title="var">a<sub>2</sub></span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="notation">×</span> <span class="id" title="var">a<sub>2</sub></span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> (<a class="idref" href="StaticIFC.html#label_of_aexp:54"><span class="id" title="definition">label_of_aexp</span></a> <a class="idref" href="StaticIFC.html#P:52"><span class="id" title="variable">P</span></a> <span class="id" title="var">a<sub>1</sub></span>) (<a class="idref" href="StaticIFC.html#label_of_aexp:54"><span class="id" title="definition">label_of_aexp</span></a> <a class="idref" href="StaticIFC.html#P:52"><span class="id" title="variable">P</span></a> <span class="id" title="var">a<sub>2</sub></span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="label_of_aexp_sound" class="idref" href="#label_of_aexp_sound"><span class="id" title="lemma">label_of_aexp_sound</span></a> : <span class="id" title="keyword">∀</span> <a id="P:56" class="idref" href="#P:56"><span class="id" title="binder">P</span></a> <a id="a:57" class="idref" href="#a:57"><span class="id" title="binder">a</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:56"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a:57"><span class="id" title="variable">a</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#label_of_aexp"><span class="id" title="definition">label_of_aexp</span></a> <a class="idref" href="StaticIFC.html#P:56"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#a:57"><span class="id" title="variable">a</span></a>.<br/>
<div class="togglescript" id="proofcontrol2" onclick="toggleDisplay('proof2');toggleDisplay('proofcontrol2')"><span class="show"></span></div>
<div class="proofscript" id="proof2" onclick="toggleDisplay('proof2');toggleDisplay('proofcontrol2')">
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="label_of_aexp_unique" class="idref" href="#label_of_aexp_unique"><span class="id" title="lemma">label_of_aexp_unique</span></a> : <span class="id" title="keyword">∀</span> <a id="P:58" class="idref" href="#P:58"><span class="id" title="binder">P</span></a> <a id="a:59" class="idref" href="#a:59"><span class="id" title="binder">a</span></a> <a id="l:60" class="idref" href="#l:60"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:58"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a:59"><span class="id" title="variable">a</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:60"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#l:60"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#label_of_aexp"><span class="id" title="definition">label_of_aexp</span></a> <a class="idref" href="StaticIFC.html#P:58"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#a:59"><span class="id" title="variable">a</span></a>.<br/>
<div class="togglescript" id="proofcontrol3" onclick="toggleDisplay('proof3');toggleDisplay('proofcontrol3')"><span class="show"></span></div>
<div class="proofscript" id="proof3" onclick="toggleDisplay('proof3');toggleDisplay('proofcontrol3')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Theorem</span> <a id="noninterferent_aexp" class="idref" href="#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> : <span class="id" title="keyword">∀</span> {<a id="P:61" class="idref" href="#P:61"><span class="id" title="binder">P</span></a> <a id="s<sub>1</sub>:62" class="idref" href="#s<sub>1</sub>:62"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:63" class="idref" href="#s<sub>2</sub>:63"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="a:64" class="idref" href="#a:64"><span class="id" title="binder">a</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:61"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:62"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:63"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:61"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a:64"><span class="id" title="variable">a</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">aeval</span> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:62"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#a:64"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">aeval</span> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:63"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#a:64"><span class="id" title="variable">a</span></a>.<br/>
<div class="togglescript" id="proofcontrol4" onclick="toggleDisplay('proof4');toggleDisplay('proofcontrol4')"><span class="show"></span></div>
<div class="proofscript" id="proof4" onclick="toggleDisplay('proof4');toggleDisplay('proofcontrol4')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">a</span> <span class="id" title="var">Heq</span> <span class="id" title="var">Ht</span>. <span class="id" title="var">remember</span> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Heql</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="StaticIFC.html#join_public"><span class="id" title="lemma">join_public</span></a> <span class="id" title="var">Heql</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt1</span> <span class="id" title="var">H<sub>1</sub></span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt2</span> <span class="id" title="var">H<sub>2</sub></span>). <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="StaticIFC.html#join_public"><span class="id" title="lemma">join_public</span></a> <span class="id" title="var">Heql</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt1</span> <span class="id" title="var">H<sub>1</sub></span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt2</span> <span class="id" title="var">H<sub>2</sub></span>). <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="StaticIFC.html#join_public"><span class="id" title="lemma">join_public</span></a> <span class="id" title="var">Heql</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt1</span> <span class="id" title="var">H<sub>1</sub></span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt2</span> <span class="id" title="var">H<sub>2</sub></span>). <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (T_True) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- true &#x2208; public</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (T_False) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- false &#x2208; public</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a<sub>1</sub> &#x2208; l<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;a- a<sub>2</sub> &#x2208; l<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (T_Eq) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- a<sub>1</sub>=a<sub>2</sub> &#x2208; join l<sub>1</sub> l<sub>2</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">...</td>
  <td></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule"></td>
  <td></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b &#x2208; l</td>
  <td class="infrulenamecol" rowspan="3">
    (T_Not) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- ~b &#x2208; l</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b<sub>1</sub> &#x2208; l<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;b- b<sub>2</sub> &#x2208; l<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (T_And) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b<sub>1</sub>&&b<sub>2</sub> &#x2208; join l<sub>1</sub> l<sub>2</sub></td>
  <td></td>
</tr>
</table></center>
</div>
<div class="code">

<span class="id" title="keyword">Reserved Notation</span> &quot;P '&#x22A2;b-' b &#x2208; l" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Inductive</span> <a id="bexp_has_label" class="idref" href="#bexp_has_label"><span class="id" title="definition, inductive"><span id="bexp_has_label_ind" class="id"><span id="bexp_has_label_sind" class="id">bexp_has_label</span></span></span></a> (<a id="P:65" class="idref" href="#P:65"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) : <span class="id" title="inductive">bexp</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="T_True" class="idref" href="#T_True"><span class="id" title="constructor">T_True</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">true</span> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a><br/>
&nbsp;&nbsp;| <a id="T_False" class="idref" href="#T_False"><span class="id" title="constructor">T_False</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">false</span> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a><br/>
&nbsp;&nbsp;| <a id="T_Eq" class="idref" href="#T_Eq"><span class="id" title="constructor">T_Eq</span></a> : <span class="id" title="keyword">∀</span> <a id="a<sub>1</sub>:68" class="idref" href="#a<sub>1</sub>:68"><span class="id" title="binder">a<sub>1</sub></span></a> <a id="l<sub>1</sub>:69" class="idref" href="#l<sub>1</sub>:69"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="a<sub>2</sub>:70" class="idref" href="#a<sub>2</sub>:70"><span class="id" title="binder">a<sub>2</sub></span></a> <a id="l<sub>2</sub>:71" class="idref" href="#l<sub>2</sub>:71"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:68"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:69"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:70"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:71"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:68"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="notation">=</span> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:70"><span class="id" title="variable">a<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:69"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:71"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="T_Neq" class="idref" href="#T_Neq"><span class="id" title="constructor">T_Neq</span></a> : <span class="id" title="keyword">∀</span> <a id="a<sub>1</sub>:72" class="idref" href="#a<sub>1</sub>:72"><span class="id" title="binder">a<sub>1</sub></span></a> <a id="l<sub>1</sub>:73" class="idref" href="#l<sub>1</sub>:73"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="a<sub>2</sub>:74" class="idref" href="#a<sub>2</sub>:74"><span class="id" title="binder">a<sub>2</sub></span></a> <a id="l<sub>2</sub>:75" class="idref" href="#l<sub>2</sub>:75"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:72"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:73"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:74"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:75"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:72"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="notation">≠</span> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:74"><span class="id" title="variable">a<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:73"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:75"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="T_Le" class="idref" href="#T_Le"><span class="id" title="constructor">T_Le</span></a> : <span class="id" title="keyword">∀</span> <a id="a<sub>1</sub>:76" class="idref" href="#a<sub>1</sub>:76"><span class="id" title="binder">a<sub>1</sub></span></a> <a id="l<sub>1</sub>:77" class="idref" href="#l<sub>1</sub>:77"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="a<sub>2</sub>:78" class="idref" href="#a<sub>2</sub>:78"><span class="id" title="binder">a<sub>2</sub></span></a> <a id="l<sub>2</sub>:79" class="idref" href="#l<sub>2</sub>:79"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:76"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:77"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:78"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:79"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:76"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="notation">≤</span> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:78"><span class="id" title="variable">a<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:77"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:79"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="T_Gt" class="idref" href="#T_Gt"><span class="id" title="constructor">T_Gt</span></a> : <span class="id" title="keyword">∀</span> <a id="a<sub>1</sub>:80" class="idref" href="#a<sub>1</sub>:80"><span class="id" title="binder">a<sub>1</sub></span></a> <a id="l<sub>1</sub>:81" class="idref" href="#l<sub>1</sub>:81"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="a<sub>2</sub>:82" class="idref" href="#a<sub>2</sub>:82"><span class="id" title="binder">a<sub>2</sub></span></a> <a id="l<sub>2</sub>:83" class="idref" href="#l<sub>2</sub>:83"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:80"><span class="id" title="variable">a<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:81"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:82"><span class="id" title="variable">a<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:83"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#a<sub>1</sub>:80"><span class="id" title="variable">a<sub>1</sub></span></a> <span class="id" title="notation">&gt;</span> <a class="idref" href="StaticIFC.html#a<sub>2</sub>:82"><span class="id" title="variable">a<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:81"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:83"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="T_Not" class="idref" href="#T_Not"><span class="id" title="constructor">T_Not</span></a> : <span class="id" title="keyword">∀</span> <a id="b:84" class="idref" href="#b:84"><span class="id" title="binder">b</span></a> <a id="l:85" class="idref" href="#l:85"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:84"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:85"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">¬</span><a class="idref" href="StaticIFC.html#b:84"><span class="id" title="variable">b</span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:85"><span class="id" title="variable">l</span></a><br/>
&nbsp;&nbsp;| <a id="T_And" class="idref" href="#T_And"><span class="id" title="constructor">T_And</span></a> : <span class="id" title="keyword">∀</span> <a id="b<sub>1</sub>:86" class="idref" href="#b<sub>1</sub>:86"><span class="id" title="binder">b<sub>1</sub></span></a> <a id="l<sub>1</sub>:87" class="idref" href="#l<sub>1</sub>:87"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="b<sub>2</sub>:88" class="idref" href="#b<sub>2</sub>:88"><span class="id" title="binder">b<sub>2</sub></span></a> <a id="l<sub>2</sub>:89" class="idref" href="#l<sub>2</sub>:89"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b<sub>1</sub>:86"><span class="id" title="variable">b<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:87"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b<sub>2</sub>:88"><span class="id" title="variable">b<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:89"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:65"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#b<sub>1</sub>:86"><span class="id" title="variable">b<sub>1</sub></span></a> <span class="id" title="notation">&amp;&amp;</span> <a class="idref" href="StaticIFC.html#b<sub>2</sub>:88"><span class="id" title="variable">b<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:87"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:89"><span class="id" title="variable">l<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">)</span></a><br/>
<br/>
<span class="id" title="keyword">where</span> <a id="42fedf909cd00a38e584747953581bd<sub>3</sub>" class="idref" href="#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&quot;</span></a>P '&#x22A2;b-' b '&#x2208;' l" := (<a class="idref" href="StaticIFC.html#bexp_has_label:67"><span class="id" title="inductive">bexp_has_label</span></a> <span class="id" title="var">P</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>).<br/>
</div>

<div class="doc">
<a id="lab32"></a><h2 class="section">Computing labels of boolean expressions</h2>

</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="label_of_bexp" class="idref" href="#label_of_bexp"><span class="id" title="definition">label_of_bexp</span></a> (<a id="P:90" class="idref" href="#P:90"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) (<a id="a:91" class="idref" href="#a:91"><span class="id" title="binder">a</span></a>:<span class="id" title="inductive">bexp</span>) : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="StaticIFC.html#a:91"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">true</span> <span class="id" title="notation">}&gt;</span> | <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">false</span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="notation">=</span> <span class="id" title="var">a<sub>2</sub></span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="notation">≠</span> <span class="id" title="var">a<sub>2</sub></span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="notation">≤</span> <span class="id" title="var">a<sub>2</sub></span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">a<sub>1</sub></span> <span class="id" title="notation">&gt;</span> <span class="id" title="var">a<sub>2</sub></span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> (<a class="idref" href="StaticIFC.html#label_of_aexp"><span class="id" title="definition">label_of_aexp</span></a> <a class="idref" href="StaticIFC.html#P:90"><span class="id" title="variable">P</span></a> <span class="id" title="var">a<sub>1</sub></span>) (<a class="idref" href="StaticIFC.html#label_of_aexp"><span class="id" title="definition">label_of_aexp</span></a> <a class="idref" href="StaticIFC.html#P:90"><span class="id" title="variable">P</span></a> <span class="id" title="var">a<sub>2</sub></span>)<br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">¬</span><span class="id" title="var">b</span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#label_of_bexp:92"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:90"><span class="id" title="variable">P</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">b<sub>1</sub></span> <span class="id" title="notation">&amp;&amp;</span> <span class="id" title="var">b<sub>2</sub></span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> (<a class="idref" href="StaticIFC.html#label_of_bexp:92"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:90"><span class="id" title="variable">P</span></a> <span class="id" title="var">b<sub>1</sub></span>) (<a class="idref" href="StaticIFC.html#label_of_bexp:92"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:90"><span class="id" title="variable">P</span></a> <span class="id" title="var">b<sub>2</sub></span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="label_of_bexp_sound" class="idref" href="#label_of_bexp_sound"><span class="id" title="lemma">label_of_bexp_sound</span></a> : <span class="id" title="keyword">∀</span> <a id="P:94" class="idref" href="#P:94"><span class="id" title="binder">P</span></a> <a id="b:95" class="idref" href="#b:95"><span class="id" title="binder">b</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:94"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:95"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#label_of_bexp"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:94"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#b:95"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">b</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">constructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="StaticIFC.html#label_of_aexp_sound"><span class="id" title="lemma">label_of_aexp_sound</span></a>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="label_of_bexp_unique" class="idref" href="#label_of_bexp_unique"><span class="id" title="lemma">label_of_bexp_unique</span></a> : <span class="id" title="keyword">∀</span> <a id="P:96" class="idref" href="#P:96"><span class="id" title="binder">P</span></a> <a id="b:97" class="idref" href="#b:97"><span class="id" title="binder">b</span></a> <a id="l:98" class="idref" href="#l:98"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:96"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:97"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:98"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#l:98"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#label_of_bexp"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:96"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#b:97"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *;<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <span class="id" title="var">_</span> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <span class="id" title="var">_</span> &#x22A2; <span class="id" title="var">_</span>] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_aexp_unique"><span class="id" title="lemma">label_of_aexp_unique</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [<span class="id" title="var">Heql</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">_</span> &#x22A2; <span class="id" title="var">_</span>] ⇒ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heql</span> <span class="id" title="keyword">in</span> ×<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>); <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="noninterferent_bexp" class="idref" href="#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> : <span class="id" title="keyword">∀</span> {<a id="P:99" class="idref" href="#P:99"><span class="id" title="binder">P</span></a> <a id="s<sub>1</sub>:100" class="idref" href="#s<sub>1</sub>:100"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:101" class="idref" href="#s<sub>2</sub>:101"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="b:102" class="idref" href="#b:102"><span class="id" title="binder">b</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:99"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:100"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:101"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:99"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:102"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">beval</span> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:100"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#b:102"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">beval</span> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:101"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#b:102"><span class="id" title="variable">b</span></a>.<br/>
<div class="togglescript" id="proofcontrol5" onclick="toggleDisplay('proof5');toggleDisplay('proofcontrol5')"><span class="show"></span></div>
<div class="proofscript" id="proof5" onclick="toggleDisplay('proof5');toggleDisplay('proofcontrol5')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">b</span> <span class="id" title="var">Heq</span> <span class="id" title="var">Ht</span>. <span class="id" title="var">remember</span> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Ht</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">destruct</span> (<a class="idref" href="StaticIFC.html#join_public"><span class="id" title="lemma">join_public</span></a> <span class="id" title="var">Heql</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H<sub>2</sub></span> <span class="id" title="keyword">in</span> *).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>0</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>0</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>0</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>0</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt</span> <span class="id" title="var">Heql</span>). <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt1</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">Logic.eq_refl</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHHt2</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">Logic.eq_refl</span></a>). <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab33"></a><h1 class="section">Restrictive type system prohibiting branching on secrets</h1>

<div class="paragraph"> </div>

 For commands, we start with a simple type system that doesn't
    allow any branching on secrets, which is so strong that on its own
    prevents all implicit flows. 
<div class="paragraph"> </div>

 For preventing explicit flows when typing assignments, we need to
    define when it is okay for information to flow from an expression
    with label <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> to a variable with label <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="can_flow" class="idref" href="#can_flow"><span class="id" title="definition">can_flow</span></a> (<a id="l<sub>1</sub>:103" class="idref" href="#l<sub>1</sub>:103"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:104" class="idref" href="#l<sub>2</sub>:104"><span class="id" title="binder">l<sub>2</sub></span></a> : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> := <a class="idref" href="StaticIFC.html#l<sub>1</sub>:103"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#081ff67d3116402bb680e8692aa39185"><span class="id" title="notation">||</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#negb"><span class="id" title="definition">negb</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:104"><span class="id" title="variable">l<sub>2</sub></span></a>.<br/>
</div>

<div class="doc">
One way to read this is as boolean implication from <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span> to <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span>,
    so <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> can flow to <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span> iff <span class="inlinecode"><span class="id" title="var">l<sub>2</sub></span></span> is public implies that <span class="inlinecode"><span class="id" title="var">l<sub>1</sub></span></span> is
    public as well. In particular, this disallows that the value of
    secret expressions be assigned to public variables: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="cannot_flow_secret_public" class="idref" href="#cannot_flow_secret_public"><span class="id" title="lemma">cannot_flow_secret_public</span></a> : <a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">false</span>.<br/>
<div class="togglescript" id="proofcontrol6" onclick="toggleDisplay('proof6');toggleDisplay('proofcontrol6')"><span class="show"></span></div>
<div class="proofscript" id="proof6" onclick="toggleDisplay('proof6');toggleDisplay('proofcontrol6')">
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
This allows public information to flow everywhere, and secret
    information to flow to secret variables: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="can_flow_public" class="idref" href="#can_flow_public"><span class="id" title="lemma">can_flow_public</span></a> : <span class="id" title="keyword">∀</span> <a id="l:105" class="idref" href="#l:105"><span class="id" title="binder">l</span></a>, <a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#l:105"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<div class="togglescript" id="proofcontrol7" onclick="toggleDisplay('proof7');toggleDisplay('proofcontrol7')"><span class="show"></span></div>
<div class="proofscript" id="proof7" onclick="toggleDisplay('proof7');toggleDisplay('proofcontrol7')">
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>
<span class="id" title="keyword">Lemma</span> <a id="can_flow_secret" class="idref" href="#can_flow_secret"><span class="id" title="lemma">can_flow_secret</span></a> : <a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<div class="togglescript" id="proofcontrol8" onclick="toggleDisplay('proof8');toggleDisplay('proofcontrol8')"><span class="show"></span></div>
<div class="proofscript" id="proof8" onclick="toggleDisplay('proof8');toggleDisplay('proofcontrol8')">
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="can_flow_refl" class="idref" href="#can_flow_refl"><span class="id" title="lemma">can_flow_refl</span></a> : <span class="id" title="keyword">∀</span> <a id="l:106" class="idref" href="#l:106"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l:106"><span class="id" title="variable">l</span></a> <a class="idref" href="StaticIFC.html#l:106"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> [|]; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="can_flow_trans" class="idref" href="#can_flow_trans"><span class="id" title="lemma">can_flow_trans</span></a> : <span class="id" title="keyword">∀</span> <a id="l<sub>1</sub>:107" class="idref" href="#l<sub>1</sub>:107"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:108" class="idref" href="#l<sub>2</sub>:108"><span class="id" title="binder">l<sub>2</sub></span></a> <a id="l<sub>3</sub>:109" class="idref" href="#l<sub>3</sub>:109"><span class="id" title="binder">l<sub>3</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:107"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:108"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:108"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>3</sub>:109"><span class="id" title="variable">l<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:107"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>3</sub>:109"><span class="id" title="variable">l<sub>3</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l<sub>1</sub></span> <span class="id" title="var">l<sub>2</sub></span> <span class="id" title="var">l<sub>3</sub></span> <span class="id" title="var">H<sub>12</sub></span> <span class="id" title="var">H<sub>23</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>1</sub></span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>2</sub></span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>12</sub></span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="can_flow_join_1" class="idref" href="#can_flow_join_1"><span class="id" title="lemma">can_flow_join_1</span></a> : <span class="id" title="keyword">∀</span> <a id="l<sub>1</sub>:110" class="idref" href="#l<sub>1</sub>:110"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:111" class="idref" href="#l<sub>2</sub>:111"><span class="id" title="binder">l<sub>2</sub></span></a> <a id="l:112" class="idref" href="#l:112"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:110"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:111"><span class="id" title="variable">l<sub>2</sub></span></a>) <a class="idref" href="StaticIFC.html#l:112"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:110"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l:112"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l<sub>1</sub></span> <span class="id" title="var">l<sub>2</sub></span> <span class="id" title="var">l</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>1</sub></span>; [<span class="id" title="tactic">reflexivity</span> | <span class="id" title="tactic">auto</span> ]. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="can_flow_join_2" class="idref" href="#can_flow_join_2"><span class="id" title="lemma">can_flow_join_2</span></a> : <span class="id" title="keyword">∀</span> <a id="l<sub>1</sub>:113" class="idref" href="#l<sub>1</sub>:113"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:114" class="idref" href="#l<sub>2</sub>:114"><span class="id" title="binder">l<sub>2</sub></span></a> <a id="l:115" class="idref" href="#l:115"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:113"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:114"><span class="id" title="variable">l<sub>2</sub></span></a>) <a class="idref" href="StaticIFC.html#l:115"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:114"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#l:115"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l<sub>1</sub></span> <span class="id" title="var">l<sub>2</sub></span> <span class="id" title="var">l</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>1</sub></span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>2</sub></span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="can_flow_join_l" class="idref" href="#can_flow_join_l"><span class="id" title="lemma">can_flow_join_l</span></a> : <span class="id" title="keyword">∀</span> <a id="l<sub>1</sub>:116" class="idref" href="#l<sub>1</sub>:116"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:117" class="idref" href="#l<sub>2</sub>:117"><span class="id" title="binder">l<sub>2</sub></span></a> <a id="l:118" class="idref" href="#l:118"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:116"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l:118"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:117"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#l:118"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:116"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:117"><span class="id" title="variable">l<sub>2</sub></span></a>) <a class="idref" href="StaticIFC.html#l:118"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l<sub>1</sub></span> <span class="id" title="var">l<sub>2</sub></span> <span class="id" title="var">l</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>1</sub></span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="can_flow_join_r<sub>1</sub>" class="idref" href="#can_flow_join_r<sub>1</sub>"><span class="id" title="lemma">can_flow_join_r<sub>1</sub></span></a> : <span class="id" title="keyword">∀</span> <a id="l:119" class="idref" href="#l:119"><span class="id" title="binder">l</span></a> <a id="l<sub>1</sub>:120" class="idref" href="#l<sub>1</sub>:120"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:121" class="idref" href="#l<sub>2</sub>:121"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l:119"><span class="id" title="variable">l</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:120"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l:119"><span class="id" title="variable">l</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:120"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:121"><span class="id" title="variable">l<sub>2</sub></span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">l<sub>1</sub></span> <span class="id" title="var">l<sub>2</sub></span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>1</sub></span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="can_flow_join_r<sub>2</sub>" class="idref" href="#can_flow_join_r<sub>2</sub>"><span class="id" title="lemma">can_flow_join_r<sub>2</sub></span></a> : <span class="id" title="keyword">∀</span> <a id="l:122" class="idref" href="#l:122"><span class="id" title="binder">l</span></a> <a id="l<sub>1</sub>:123" class="idref" href="#l<sub>1</sub>:123"><span class="id" title="binder">l<sub>1</sub></span></a> <a id="l<sub>2</sub>:124" class="idref" href="#l<sub>2</sub>:124"><span class="id" title="binder">l<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l:122"><span class="id" title="variable">l</span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:124"><span class="id" title="variable">l<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l:122"><span class="id" title="variable">l</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#l<sub>1</sub>:123"><span class="id" title="variable">l<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#l<sub>2</sub>:124"><span class="id" title="variable">l<sub>2</sub></span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">intros</span> <span class="id" title="var">l</span> <span class="id" title="var">l<sub>1</sub></span> <span class="id" title="var">l<sub>2</sub></span> <span class="id" title="var">H</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">l<sub>1</sub></span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
For commands we use the previous relations to define a
    <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> relation inductively using the following rules: 
<div class="paragraph"> </div>

 <center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (PCWT_Skip) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;pc- skip</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a &#x2208; l&nbsp;&nbsp;&nbsp;&nbsp;can_flow l (P X) = true</td>
  <td class="infrulenamecol" rowspan="3">
    (PCWT_Asgn) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;pc- X := a</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;pc- c<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;pc- c<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (PCWT_Seq) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;pc- c<sub>1</sub>;c<sub>2</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b &#x2208; public&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;pc- c<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;pc- c<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (PCWT_If) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;pc- if b then c<sub>1</sub> else c<sub>2</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b &#x2208; public&nbsp;&nbsp;&nbsp;&nbsp;P &#x22A2;pc- c</td>
  <td class="infrulenamecol" rowspan="3">
    (PCWT_While) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;pc- while b then c end</td>
  <td></td>
</tr>
</table></center>
<div class="paragraph"> </div>

 Intuitively, explicit flows are prevented by the <span class="inlinecode"><span class="id" title="var">can_flow</span></span>
    requirement in the assignment rule and implicit flows are
    prevented by the requirement that the boolean condition of <span class="inlinecode"><span class="id" title="keyword">if</span></span>
    and <span class="inlinecode"><span class="id" title="var">while</span></span> has to be a public expression. 
</div>
<div class="code">

<span class="id" title="keyword">Reserved Notation</span> &quot;P '&#x22A2;pc-' c" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Inductive</span> <a id="pc_well_typed" class="idref" href="#pc_well_typed"><span class="id" title="definition, inductive"><span id="pc_well_typed_ind" class="id"><span id="pc_well_typed_sind" class="id">pc_well_typed</span></span></span></a> (<a id="P:125" class="idref" href="#P:125"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) : <span class="id" title="inductive">com</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="PCWT_Com" class="idref" href="#PCWT_Com"><span class="id" title="constructor">PCWT_Com</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">skip</span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="PCWT_Asgn" class="idref" href="#PCWT_Asgn"><span class="id" title="constructor">PCWT_Asgn</span></a> : <span class="id" title="keyword">∀</span> <a id="X:128" class="idref" href="#X:128"><span class="id" title="binder">X</span></a> <a id="a:129" class="idref" href="#a:129"><span class="id" title="binder">a</span></a> <a id="l:130" class="idref" href="#l:130"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a:129"><span class="id" title="variable">a</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:130"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#l:130"><span class="id" title="variable">l</span></a> (<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#X:128"><span class="id" title="variable">X</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#X:128"><span class="id" title="variable">X</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="StaticIFC.html#a:129"><span class="id" title="variable">a</span></a> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="PCWT_Seq" class="idref" href="#PCWT_Seq"><span class="id" title="constructor">PCWT_Seq</span></a> : <span class="id" title="keyword">∀</span> <a id="c<sub>1</sub>:131" class="idref" href="#c<sub>1</sub>:131"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:132" class="idref" href="#c<sub>2</sub>:132"><span class="id" title="binder">c<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:131"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:132"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:131"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">;</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:132"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="PCWT_If" class="idref" href="#PCWT_If"><span class="id" title="constructor">PCWT_If</span></a> : <span class="id" title="keyword">∀</span> <a id="b:133" class="idref" href="#b:133"><span class="id" title="binder">b</span></a> <a id="c<sub>1</sub>:134" class="idref" href="#c<sub>1</sub>:134"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:135" class="idref" href="#c<sub>2</sub>:135"><span class="id" title="binder">c<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:133"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:134"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:135"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <a class="idref" href="StaticIFC.html#b:133"><span class="id" title="variable">b</span></a> <span class="id" title="notation">then</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:134"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">else</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:135"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="PCWT_While" class="idref" href="#PCWT_While"><span class="id" title="constructor">PCWT_While</span></a> : <span class="id" title="keyword">∀</span> <a id="b:136" class="idref" href="#b:136"><span class="id" title="binder">b</span></a> <a id="c<sub>1</sub>:137" class="idref" href="#c<sub>1</sub>:137"><span class="id" title="binder">c<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:136"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:137"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:125"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">while</span> <a class="idref" href="StaticIFC.html#b:136"><span class="id" title="variable">b</span></a> <span class="id" title="notation">do</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:137"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span><br/>
<br/>
<span class="id" title="keyword">where</span> <a id="d14a14cbe43755d0c5387962d2da5148" class="idref" href="#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&quot;</span></a>P '&#x22A2;pc-' c" := (<a class="idref" href="StaticIFC.html#pc_well_typed:127"><span class="id" title="inductive">pc_well_typed</span></a> <span class="id" title="var">P</span> <span class="id" title="var">c</span>).<br/>
</div>

<div class="doc">
<a id="lab34"></a><h2 class="section">Typechecker for <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span></h2>

</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="pc_typechecker" class="idref" href="#pc_typechecker"><span class="id" title="definition">pc_typechecker</span></a> (<a id="P:138" class="idref" href="#P:138"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) (<a id="c:139" class="idref" href="#c:139"><span class="id" title="binder">c</span></a>:<span class="id" title="inductive">com</span>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="StaticIFC.html#c:139"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">skip</span> <span class="id" title="notation">}&gt;</span> ⇒ <span class="id" title="notation">true</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">X</span> <span class="id" title="notation">:=</span> <span class="id" title="var">a</span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> (<a class="idref" href="StaticIFC.html#label_of_aexp"><span class="id" title="definition">label_of_aexp</span></a> <a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">a</span>) (<a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="notation">;</span> <span class="id" title="var">c<sub>2</sub></span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#pc_typechecker:140"><span class="id" title="definition">pc_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">c<sub>1</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="StaticIFC.html#pc_typechecker:140"><span class="id" title="definition">pc_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">c<sub>2</sub></span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="var">b</span> <span class="id" title="notation">then</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="notation">else</span> <span class="id" title="var">c<sub>2</sub></span> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#eqb"><span class="id" title="definition">Bool.eqb</span></a> (<a class="idref" href="StaticIFC.html#label_of_bexp"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">b</span>) <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pc_typechecker:140"><span class="id" title="definition">pc_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">c<sub>1</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="StaticIFC.html#pc_typechecker:140"><span class="id" title="definition">pc_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">c<sub>2</sub></span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">while</span> <span class="id" title="var">b</span> <span class="id" title="notation">do</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#eqb"><span class="id" title="definition">Bool.eqb</span></a> (<a class="idref" href="StaticIFC.html#label_of_bexp"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">b</span>) <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="StaticIFC.html#pc_typechecker:140"><span class="id" title="definition">pc_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:138"><span class="id" title="variable">P</span></a> <span class="id" title="var">c<sub>1</sub></span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
</div>

<div class="doc">
This typechecker is sound and complete with respect to the
    <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> relation. 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="pc_typechecker_sound" class="idref" href="#pc_typechecker_sound"><span class="id" title="lemma">pc_typechecker_sound</span></a> : <span class="id" title="keyword">∀</span> <a id="P:142" class="idref" href="#P:142"><span class="id" title="binder">P</span></a> <a id="c:143" class="idref" href="#c:143"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pc_typechecker"><span class="id" title="definition">pc_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:142"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#c:143"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:142"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:143"><span class="id" title="variable">c</span></a>.<br/>
<div class="togglescript" id="proofcontrol9" onclick="toggleDisplay('proof9');toggleDisplay('proofcontrol9')"><span class="show"></span></div>
<div class="proofscript" id="proof9" onclick="toggleDisplay('proof9');toggleDisplay('proofcontrol9')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="StaticIFC.html#label_of_aexp_sound"><span class="id" title="lemma">label_of_aexp_sound</span></a>, <a class="idref" href="StaticIFC.html#label_of_bexp_sound"><span class="id" title="lemma">label_of_bexp_sound</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>]. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>1</sub></span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>1</sub></span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H<sub>11</sub></span> <span class="id" title="var">H<sub>12</sub></span>]. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#eqb_prop"><span class="id" title="lemma">Bool.eqb_prop</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>11</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H<sub>11</sub></span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_bexp_sound"><span class="id" title="lemma">label_of_bexp_sound</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>]. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>1</sub></span>; <span class="id" title="tactic">tauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H<sub>1</sub></span> <span class="id" title="var">H<sub>2</sub></span>]. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#eqb_prop"><span class="id" title="lemma">Bool.eqb_prop</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>1</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H<sub>1</sub></span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_bexp_sound"><span class="id" title="lemma">label_of_bexp_sound</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="pc_typechecker_complete" class="idref" href="#pc_typechecker_complete"><span class="id" title="lemma">pc_typechecker_complete</span></a> : <span class="id" title="keyword">∀</span> <a id="P:144" class="idref" href="#P:144"><span class="id" title="binder">P</span></a> <a id="c:145" class="idref" href="#c:145"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pc_typechecker"><span class="id" title="definition">pc_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:144"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#c:145"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">false</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a><a class="idref" href="StaticIFC.html#P:144"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:145"><span class="id" title="variable">c</span></a>.<br/>
<div class="togglescript" id="proofcontrol10" onclick="toggleDisplay('proof10');toggleDisplay('proofcontrol10')"><span class="show"></span></div>
<div class="proofscript" id="proof10" onclick="toggleDisplay('proof10');toggleDisplay('proofcontrol10')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">H</span> <span class="id" title="var">Hc</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">Hc</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#andb_false_iff"><span class="id" title="lemma">andb_false_iff</span></a> <span class="id" title="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_aexp_unique"><span class="id" title="lemma">label_of_aexp_unique</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="keyword">in</span> ×. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#andb_false_iff"><span class="id" title="lemma">andb_false_iff</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#eqb_false_iff"><span class="id" title="lemma">eqb_false_iff</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_bexp_unique"><span class="id" title="lemma">label_of_bexp_unique</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">eauto</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#eqb_false_iff"><span class="id" title="lemma">eqb_false_iff</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_bexp_unique"><span class="id" title="lemma">label_of_bexp_unique</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab35"></a><h2 class="section">Secure program that is <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span>:</h2>

</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="pc_wt_secure_com" class="idref" href="#pc_wt_secure_com"><span class="id" title="definition">pc_wt_secure_com</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span>1<span class="id" title="notation">;</span>  <span class="comment">(*&nbsp;check:&nbsp;can_flow&nbsp;public&nbsp;public&nbsp;(OK!)&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Y</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span><span class="id" title="definition">Y</span><span class="id" title="notation">×</span>2 <span class="comment">(*&nbsp;check:&nbsp;can_flow&nbsp;secret&nbsp;secret&nbsp;(OK!)&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">}&gt;</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#pc_typechecker_sound"><span class="id" title="lemma">pc_typechecker_sound</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab36"></a><h2 class="section">Explicit flow prevented by <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span>:</h2>

</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="not_pc_wt_insecure_com1" class="idref" href="#not_pc_wt_insecure_com1"><span class="id" title="definition">not_pc_wt_insecure_com1</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">Y</span><span class="id" title="notation">+</span>1<span class="id" title="notation">;</span>  <span class="comment">(*&nbsp;check:&nbsp;can_flow&nbsp;secret&nbsp;public&nbsp;(FAILS!)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">Y</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span><span class="id" title="definition">Y</span><span class="id" title="notation">×</span>2 <span class="comment">(*&nbsp;check:&nbsp;can_flow&nbsp;secret&nbsp;secret&nbsp;(OK!)&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">}&gt;</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#pc_typechecker_complete"><span class="id" title="lemma">pc_typechecker_complete</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab37"></a><h2 class="section">Implicit flow prevented by <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span>:</h2>

</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="not_pc_wt_insecure_com2" class="idref" href="#not_pc_wt_insecure_com2"><span class="id" title="definition">not_pc_wt_insecure_com2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="definition">Y</span><span class="id" title="notation">=</span>0  <span class="comment">(*&nbsp;check:&nbsp;P&nbsp;&#x22A2;b-&nbsp;Y=0&nbsp;&#x2208;&nbsp;public&nbsp;(FAILS!)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">then</span> <span class="id" title="definition">Y</span> <span class="id" title="notation">:=</span> 42<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">else</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span>1 <span class="comment">(*&nbsp;&lt;-&nbsp;bad&nbsp;implicit&nbsp;flow!&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#pc_typechecker_complete"><span class="id" title="lemma">pc_typechecker_complete</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
We show that all <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> commands are <span class="inlinecode"><span class="id" title="var">noninterferent</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="pc_well_typed_noninterferent" class="idref" href="#pc_well_typed_noninterferent"><span class="id" title="lemma">pc_well_typed_noninterferent</span></a> : <span class="id" title="keyword">∀</span> <a id="P:146" class="idref" href="#P:146"><span class="id" title="binder">P</span></a> <a id="c:147" class="idref" href="#c:147"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:146"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:147"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a> <a class="idref" href="StaticIFC.html#P:146"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#c:147"><span class="id" title="variable">c</span></a>.<br/>
<div class="togglescript" id="proofcontrol11" onclick="toggleDisplay('proof11');toggleDisplay('proofcontrol11')"><span class="show"></span></div>
<div class="proofscript" id="proof11" onclick="toggleDisplay('proof11');toggleDisplay('proofcontrol11')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">Heq</span> <span class="id" title="var">Heval1</span> <span class="id" title="var">Heval2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub>'</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Heval1</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">Heq</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">Heval2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Heval2</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hwt</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">Hy</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#eqb_spec"><span class="id" title="lemma">String.eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hxy</span> | <span class="id" title="var">Hxy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hxy</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="axiom">t_update_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>8</sub></span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#orb_prop"><span class="id" title="lemma">orb_prop</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>8</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>8</sub></span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hl</span> | <span class="id" title="var">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">in</span> ×. <span class="id" title="tactic">apply</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>7</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hy</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> (<span class="id" title="axiom">t_update_neq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hxy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1_2</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1_1</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>10</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>5</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>5</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>10</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>5</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>5</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>9</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>7</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>4</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>4</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1_2</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1_1</span>; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
Remember the definition of <span class="inlinecode"><span class="id" title="var">noninterferent</span></span> is as follows:
<pre>
forall s<sub>1</sub> s<sub>2</sub> s<sub>1</sub>' s<sub>2</sub>',
  pub_equiv P s<sub>1</sub> s<sub>2</sub> <span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>
  s<sub>1</sub> =[ c ]=&gt; s<sub>1</sub>' <span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>
  s<sub>2</sub> =[ c ]=&gt; s<sub>2</sub>' <span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>
  pub_equiv P s<sub>1</sub>' s<sub>2</sub>'.
</pre>

<div class="paragraph"> </div>

   The main intuition is that the two executions will proceed "in
   lockstep", because all the branch conditions are enforced to be
   public, so they will execute to the same Boolean in both executions. 
<div class="paragraph"> </div>

 The proof is by induction on <span class="inlinecode"><span class="id" title="var">s<sub>1</sub></span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">s<sub>1</sub>'</span></span> and inversion
    on <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> <span class="inlinecode">=[</span> <span class="inlinecode"><span class="id" title="var">c</span></span> <span class="inlinecode">]=&gt;</span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub>'</span></span> and <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">pc</span>-</span> <span class="inlinecode"><span class="id" title="var">c</span></span>. Here is a sketch of the two
    most interesting cases:

<div class="paragraph"> </div>

<ul class="doclist">
<li> In the conditional case we have that <span class="inlinecode"><span class="id" title="var">c</span></span> is <span class="inlinecode"><span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">c<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode"><span class="id" title="var">c<sub>2</sub></span></span>,
      <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">pc</span>-</span> <span class="inlinecode"><span class="id" title="var">c<sub>1</sub></span></span>, <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">pc</span>-</span> <span class="inlinecode"><span class="id" title="var">c<sub>2</sub></span></span>, and <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">b</span>-</span> <span class="inlinecode"><span class="id" title="var">b</span></span> &#x2208; <span class="inlinecode"><span class="id" title="var">public</span></span>. Given this
      last fact we can apply noninterference of boolean expressions to
      show that <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">beval</span></span> <span class="inlinecode"><span class="id" title="var">st<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">b</span></span>. If they are both <span class="inlinecode"><span class="id" title="var">true</span></span>,
      we use the induction hypothesis for <span class="inlinecode"><span class="id" title="var">c<sub>1</sub></span></span>, and if they are both
      false we use the induction hypothesis for <span class="inlinecode"><span class="id" title="var">c<sub>2</sub></span></span> to conclude.

<div class="paragraph"> </div>


</li>
<li> In the assignment case we have that <span class="inlinecode"><span class="id" title="var">c</span></span> is <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">:=</span> <span class="inlinecode"><span class="id" title="var">a</span></span>,
      <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">a</span>-</span> <span class="inlinecode"><span class="id" title="var">a</span></span> &#x2208; <span class="inlinecode"><span class="id" title="var">l</span></span>, and <span class="inlinecode"><span class="id" title="var">can_flow</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">(<span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">X</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>, which expands out
      to <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">==</span> <span class="inlinecode"><span class="id" title="var">public</span></span> <span class="inlinecode">∨</span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">==</span> <span class="inlinecode"><span class="id" title="var">secret</span></span>.

<div class="paragraph"> </div>

      If <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">==</span> <span class="inlinecode"><span class="id" title="var">public</span></span> then by noninterference of arithmetic
      expressions then <span class="inlinecode"><span class="id" title="var">aeval</span></span> <span class="inlinecode"><span class="id" title="var">st<sub>1</sub></span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">aeval</span></span> <span class="inlinecode"><span class="id" title="var">s<sub>2</sub></span></span> <span class="inlinecode"><span class="id" title="var">a</span></span>, so we are
      assigning the same value to X, which leads to public equivalent
      final states (since the initial states were public equivalent).

<div class="paragraph"> </div>

      If <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">X</span></span> <span class="inlinecode">==</span> <span class="inlinecode"><span class="id" title="var">secret</span></span> then the value of <span class="inlinecode"><span class="id" title="var">X</span></span> doesn't matter
      for determining whether the final states are <span class="inlinecode"><span class="id" title="var">pub_equiv</span></span>. 
</li>
</ul>

<div class="paragraph"> </div>

<a id="lab38"></a><h2 class="section"><span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> too strong for noninterference</h2>

<div class="paragraph"> </div>

 While we have just proved that <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> implies
    noninterference, this is too strong a restriction for just
    noninterference. For instance, the following program contains no
    explicit flows and no implicit flows, so it is intuitively
    noninterferent, yet it is still rejected by the type system just
    because it branches on a secret: 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="not_pc_wt_noninterferent_com" class="idref" href="#not_pc_wt_noninterferent_com"><span class="id" title="definition">not_pc_wt_noninterferent_com</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="definition">Y</span><span class="id" title="notation">=</span>0 <span class="comment">(*&nbsp;check:&nbsp;P&nbsp;&#x22A2;b-&nbsp;Y=0&nbsp;&#x2208;&nbsp;public&nbsp;(fails!)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">then</span> <span class="id" title="definition">Z</span> <span class="id" title="notation">:=</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">else</span> <span class="id" title="notation">skip</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#pc_typechecker_complete"><span class="id" title="lemma">pc_typechecker_complete</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="not_pc_wt_noninterferent_com_is_noninterferent" class="idref" href="#not_pc_wt_noninterferent_com_is_noninterferent"><span class="id" title="definition">not_pc_wt_noninterferent_com_is_noninterferent</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a> <a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="definition">Y</span><span class="id" title="notation">=</span>0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">then</span> <span class="id" title="definition">Z</span> <span class="id" title="notation">:=</span> 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">else</span> <span class="id" title="notation">skip</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span>.<br/>
<div class="togglescript" id="proofcontrol12" onclick="toggleDisplay('proof12');toggleDisplay('proofcontrol12')"><span class="show"></span></div>
<div class="proofscript" id="proof12" onclick="toggleDisplay('proof12');toggleDisplay('proofcontrol12')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">H</span> <span class="id" title="var">red1</span> <span class="id" title="var">red2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">red1</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">red2</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">red1</span> <span class="id" title="var">red2</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>6</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H<sub>6</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>13</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H<sub>13</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Px</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#eqb_spec"><span class="id" title="lemma">String.eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="definition">Z</span>); <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> !<span class="id" title="axiom">t_update_neq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>6</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H<sub>6</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>13</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H<sub>13</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Px</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#eqb_spec"><span class="id" title="lemma">String.eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="definition">Z</span>); <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> !<span class="id" title="axiom">t_update_neq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>6</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H<sub>6</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>13</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H<sub>13</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Px</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#eqb_spec"><span class="id" title="lemma">String.eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="definition">Z</span>); <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> !<span class="id" title="axiom">t_update_neq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>6</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H<sub>6</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>13</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H<sub>13</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Px</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
We will later show that <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> enforces a security
    notion called program counter security, which prevents some
    side-channel attacks and which also serves as the base for
    cryptographic constant-time. 
<div class="paragraph"> </div>

<a id="lab39"></a><h1 class="section">IFC type system allowing branching on secrets</h1>

<div class="paragraph"> </div>

 We now instead extend this to a more permissive type system for
    noninterference in which we do allow branching on secrets.

<div class="paragraph"> </div>

    Now to prevent implicit flows we need to track whether we have
    branched on secrets. We do this with a <i>program counter</i> (<span class="inlinecode"><span class="id" title="var">pc</span></span>)
    label, which records the labels of the branches we have taken at
    the current point in the execution (joined together). 
<div class="paragraph"> </div>

 <center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (WT_Skip) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P ;; pc <span class="nowrap">&vert;--</span> skip</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;a- a &#x2208; l&nbsp;&nbsp;&nbsp;can_flow (join pc l) (P X) = true</td>
  <td class="infrulenamecol" rowspan="3">
    (WT_Asgn) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P ;; pc <span class="nowrap">&vert;--</span> X := a</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P ;; pc <span class="nowrap">&vert;--</span> c<sub>1</sub>&nbsp;&nbsp;&nbsp;&nbsp;P ;; pc <span class="nowrap">&vert;--</span> c<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (WT_Seq) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P ;; pc <span class="nowrap">&vert;--</span> c<sub>1</sub>;c<sub>2</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b &#x2208; l&nbsp;&nbsp;&nbsp;&nbsp;P ;; join pc l <span class="nowrap">&vert;--</span> c<sub>1</sub></td>
  <td></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P ;; join pc l <span class="nowrap">&vert;--</span> c<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (WT_If) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P ;; pc <span class="nowrap">&vert;--</span> if b then c<sub>1</sub> else c<sub>2</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b &#x2208; l&nbsp;&nbsp;&nbsp;&nbsp;P ;; join pc l <span class="nowrap">&vert;--</span> c</td>
  <td class="infrulenamecol" rowspan="3">
    (WT_While) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P ;; pc <span class="nowrap">&vert;--</span> while b then c end</td>
  <td></td>
</tr>
</table></center>
</div>
<div class="code">

<span class="id" title="keyword">Reserved Notation</span> &quot;P ';;' pc '<span class="nowrap">&vert;--</span>' c" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Inductive</span> <a id="well_typed" class="idref" href="#well_typed"><span class="id" title="definition, inductive"><span id="well_typed_ind" class="id"><span id="well_typed_sind" class="id">well_typed</span></span></span></a> (<a id="P:148" class="idref" href="#P:148"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="inductive">com</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="WT_Com" class="idref" href="#WT_Com"><span class="id" title="constructor">WT_Com</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:151" class="idref" href="#pc:151"><span class="id" title="binder">pc</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:151"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">skip</span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="WT_Asgn" class="idref" href="#WT_Asgn"><span class="id" title="constructor">WT_Asgn</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:152" class="idref" href="#pc:152"><span class="id" title="binder">pc</span></a> <a id="X:153" class="idref" href="#X:153"><span class="id" title="binder">X</span></a> <a id="a:154" class="idref" href="#a:154"><span class="id" title="binder">a</span></a> <a id="l:155" class="idref" href="#l:155"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a:154"><span class="id" title="variable">a</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:155"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:152"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#l:155"><span class="id" title="variable">l</span></a>) (<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#X:153"><span class="id" title="variable">X</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:152"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#X:153"><span class="id" title="variable">X</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="StaticIFC.html#a:154"><span class="id" title="variable">a</span></a> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="WT_Seq" class="idref" href="#WT_Seq"><span class="id" title="constructor">WT_Seq</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:156" class="idref" href="#pc:156"><span class="id" title="binder">pc</span></a> <a id="c<sub>1</sub>:157" class="idref" href="#c<sub>1</sub>:157"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:158" class="idref" href="#c<sub>2</sub>:158"><span class="id" title="binder">c<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:156"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:157"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:156"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:158"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:156"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:157"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">;</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:158"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="WT_If" class="idref" href="#WT_If"><span class="id" title="constructor">WT_If</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:159" class="idref" href="#pc:159"><span class="id" title="binder">pc</span></a> <a id="b:160" class="idref" href="#b:160"><span class="id" title="binder">b</span></a> <a id="l:161" class="idref" href="#l:161"><span class="id" title="binder">l</span></a> <a id="c<sub>1</sub>:162" class="idref" href="#c<sub>1</sub>:162"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:163" class="idref" href="#c<sub>2</sub>:163"><span class="id" title="binder">c<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:160"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:161"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:159"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#l:161"><span class="id" title="variable">l</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">)</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:162"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:159"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#l:161"><span class="id" title="variable">l</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">)</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:163"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:159"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <a class="idref" href="StaticIFC.html#b:160"><span class="id" title="variable">b</span></a> <span class="id" title="notation">then</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:162"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">else</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:163"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="WT_While" class="idref" href="#WT_While"><span class="id" title="constructor">WT_While</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:164" class="idref" href="#pc:164"><span class="id" title="binder">pc</span></a> <a id="b:165" class="idref" href="#b:165"><span class="id" title="binder">b</span></a> <a id="l:166" class="idref" href="#l:166"><span class="id" title="binder">l</span></a> <a id="c<sub>1</sub>:167" class="idref" href="#c<sub>1</sub>:167"><span class="id" title="binder">c<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:165"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:166"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:164"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#l:166"><span class="id" title="variable">l</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">)</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:167"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:148"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:164"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">while</span> <a class="idref" href="StaticIFC.html#b:165"><span class="id" title="variable">b</span></a> <span class="id" title="notation">do</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:167"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span><br/>
<br/>
<span class="id" title="keyword">where</span> <a id="3431c6a3af34615c81a4e312b0fc6708" class="idref" href="#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">&quot;</span></a>P ';;' pc '<span class="nowrap">&vert;--</span>' c" := (<a class="idref" href="StaticIFC.html#well_typed:150"><span class="id" title="inductive">well_typed</span></a> <span class="id" title="var">P</span> <span class="id" title="var">pc</span> <span class="id" title="var">c</span>).<br/>
</div>

<div class="doc">
We now allow branching on arbitrary boolean expressions in <span class="inlinecode"><span class="id" title="keyword">if</span></span>
    and <span class="inlinecode"><span class="id" title="var">while</span></span>, but join the label of the branch expression to the
    <span class="inlinecode"><span class="id" title="var">pc</span></span>. Then in the assignment rule we require that also the <span class="inlinecode"><span class="id" title="var">pc</span></span>
    label flows to the label of the assigned variable, in order to
    still prevent implicit flows. 
<div class="paragraph"> </div>

<a id="lab40"></a><h2 class="section">Typechecker for this <span class="inlinecode"><span class="id" title="var">well_typed</span></span> relation.</h2>

</div>
<div class="code">

<span class="id" title="keyword">Fixpoint</span> <a id="wt_typechecker" class="idref" href="#wt_typechecker"><span class="id" title="definition">wt_typechecker</span></a> (<a id="P:168" class="idref" href="#P:168"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) (<a id="pc:169" class="idref" href="#pc:169"><span class="id" title="binder">pc</span></a>:<a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a>) (<a id="c:170" class="idref" href="#c:170"><span class="id" title="binder">c</span></a>:<span class="id" title="inductive">com</span>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="StaticIFC.html#c:170"><span class="id" title="variable">c</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">skip</span> <span class="id" title="notation">}&gt;</span> ⇒ <span class="id" title="notation">true</span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">X</span> <span class="id" title="notation">:=</span> <span class="id" title="var">a</span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:169"><span class="id" title="variable">pc</span></a> (<a class="idref" href="StaticIFC.html#label_of_aexp"><span class="id" title="definition">label_of_aexp</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> <span class="id" title="var">a</span>)) (<a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> <span class="id" title="var">X</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="notation">;</span> <span class="id" title="var">c<sub>2</sub></span> <span class="id" title="notation">}&gt;</span> ⇒ <a class="idref" href="StaticIFC.html#wt_typechecker:171"><span class="id" title="definition">wt_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#pc:169"><span class="id" title="variable">pc</span></a> <span class="id" title="var">c<sub>1</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="StaticIFC.html#wt_typechecker:171"><span class="id" title="definition">wt_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#pc:169"><span class="id" title="variable">pc</span></a> <span class="id" title="var">c<sub>2</sub></span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="var">b</span> <span class="id" title="notation">then</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="notation">else</span> <span class="id" title="var">c<sub>2</sub></span> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#wt_typechecker:171"><span class="id" title="definition">wt_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:169"><span class="id" title="variable">pc</span></a> (<a class="idref" href="StaticIFC.html#label_of_bexp"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> <span class="id" title="var">b</span>)) <span class="id" title="var">c<sub>1</sub></span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#wt_typechecker:171"><span class="id" title="definition">wt_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:169"><span class="id" title="variable">pc</span></a> (<a class="idref" href="StaticIFC.html#label_of_bexp"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> <span class="id" title="var">b</span>)) <span class="id" title="var">c<sub>2</sub></span><br/>
&nbsp;&nbsp;| <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">while</span> <span class="id" title="var">b</span> <span class="id" title="notation">do</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#wt_typechecker:171"><span class="id" title="definition">wt_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:169"><span class="id" title="variable">pc</span></a> (<a class="idref" href="StaticIFC.html#label_of_bexp"><span class="id" title="definition">label_of_bexp</span></a> <a class="idref" href="StaticIFC.html#P:168"><span class="id" title="variable">P</span></a> <span class="id" title="var">b</span>)) <span class="id" title="var">c<sub>1</sub></span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="wt_typechecker_sound" class="idref" href="#wt_typechecker_sound"><span class="id" title="lemma">wt_typechecker_sound</span></a> : <span class="id" title="keyword">∀</span> <a id="P:173" class="idref" href="#P:173"><span class="id" title="binder">P</span></a> <a id="pc:174" class="idref" href="#pc:174"><span class="id" title="binder">pc</span></a> <a id="c:175" class="idref" href="#c:175"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#wt_typechecker"><span class="id" title="definition">wt_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:173"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#pc:174"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#c:175"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:173"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:174"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c:175"><span class="id" title="variable">c</span></a>.<br/>
<div class="togglescript" id="proofcontrol13" onclick="toggleDisplay('proof13');toggleDisplay('proofcontrol13')"><span class="show"></span></div>
<div class="proofscript" id="proof13" onclick="toggleDisplay('proof13');toggleDisplay('proofcontrol13')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">pc</span> <span class="id" title="var">c</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">pc</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">pc</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">econstructor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="StaticIFC.html#label_of_aexp_sound"><span class="id" title="lemma">label_of_aexp_sound</span></a>, <a class="idref" href="StaticIFC.html#label_of_bexp_sound"><span class="id" title="lemma">label_of_bexp_sound</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="wt_typechecker_complete" class="idref" href="#wt_typechecker_complete"><span class="id" title="lemma">wt_typechecker_complete</span></a> : <span class="id" title="keyword">∀</span> <a id="P:176" class="idref" href="#P:176"><span class="id" title="binder">P</span></a> <a id="pc:177" class="idref" href="#pc:177"><span class="id" title="binder">pc</span></a> <a id="c:178" class="idref" href="#c:178"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#wt_typechecker"><span class="id" title="definition">wt_typechecker</span></a> <a class="idref" href="StaticIFC.html#P:176"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#pc:177"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#c:178"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">false</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="StaticIFC.html#P:176"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:177"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c:178"><span class="id" title="variable">c</span></a>.<br/>
<div class="togglescript" id="proofcontrol14" onclick="toggleDisplay('proof14');toggleDisplay('proofcontrol14')"><span class="show"></span></div>
<div class="proofscript" id="proof14" onclick="toggleDisplay('proof14');toggleDisplay('proofcontrol14')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">pc</span> <span class="id" title="var">c</span> <span class="id" title="var">H</span> <span class="id" title="var">Hc</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">Hc</span>; <span class="id" title="tactic">simpl</span> <span class="id" title="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#andb_false_iff"><span class="id" title="lemma">andb_false_iff</span></a> <span class="id" title="keyword">in</span> *; <span class="id" title="tactic">try</span> <span class="id" title="tactic">tauto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_aexp_unique"><span class="id" title="lemma">label_of_aexp_unique</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H<sub>0</sub></span> <span class="id" title="keyword">in</span> ×. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_bexp_unique"><span class="id" title="lemma">label_of_bexp_unique</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#label_of_bexp_unique"><span class="id" title="lemma">label_of_bexp_unique</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
With this more permissive type system we can accept more
    noninterferent programs that were rejected by <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span>. 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="wt_noninterferent_com" class="idref" href="#wt_noninterferent_com"><span class="id" title="definition">wt_noninterferent_com</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="definition">Y</span><span class="id" title="notation">=</span>0 <span class="comment">(*&nbsp;raises&nbsp;pc&nbsp;label&nbsp;from&nbsp;public&nbsp;to&nbsp;secret&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">then</span> <span class="id" title="definition">Z</span> <span class="id" title="notation">:=</span> 0 <span class="comment">(*&nbsp;check:&nbsp;<span class="inlinecode"><span class="id" title="var">can_flow</span></span> <span class="inlinecode"><span class="id" title="var">secret</span></span> <span class="inlinecode"><span class="id" title="var">secret</span></span>&nbsp;(OK!)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">else</span> <span class="id" title="notation">skip</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#wt_typechecker_sound"><span class="id" title="lemma">wt_typechecker_sound</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
And we still prevent implicit flows: 
</div>
<div class="code">

<span class="id" title="keyword">Example</span> <a id="not_wt_insecure_com2" class="idref" href="#not_wt_insecure_com2"><span class="id" title="definition">not_wt_insecure_com2</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="StaticIFC.html#xpub"><span class="id" title="definition">xpub</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <span class="id" title="definition">Y</span><span class="id" title="notation">=</span>0  <span class="comment">(*&nbsp;raises&nbsp;pc&nbsp;label&nbsp;from&nbsp;public&nbsp;to&nbsp;secret&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">then</span> <span class="id" title="definition">Y</span> <span class="id" title="notation">:=</span> 42<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">else</span> <span class="id" title="definition">X</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">X</span><span class="id" title="notation">+</span>1 <span class="comment">(*&nbsp;check:&nbsp;<span class="inlinecode"><span class="id" title="var">can_flow</span></span> <span class="inlinecode"><span class="id" title="var">secret</span></span> <span class="inlinecode"><span class="id" title="var">public</span></span>&nbsp;(FAILS!)&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#wt_typechecker_complete"><span class="id" title="lemma">wt_typechecker_complete</span></a>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="weaken_pc" class="idref" href="#weaken_pc"><span class="id" title="lemma">weaken_pc</span></a> : <span class="id" title="keyword">∀</span> {<a id="P:179" class="idref" href="#P:179"><span class="id" title="binder">P</span></a> <a id="pc<sub>1</sub>:180" class="idref" href="#pc<sub>1</sub>:180"><span class="id" title="binder">pc<sub>1</sub></span></a> <a id="pc<sub>2</sub>:181" class="idref" href="#pc<sub>2</sub>:181"><span class="id" title="binder">pc<sub>2</sub></span></a> <a id="c:182" class="idref" href="#c:182"><span class="id" title="binder">c</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:179"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc<sub>1</sub>:180"><span class="id" title="variable">pc<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c:182"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <a class="idref" href="StaticIFC.html#pc<sub>2</sub>:181"><span class="id" title="variable">pc<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#pc<sub>1</sub>:180"><span class="id" title="variable">pc<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:179"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc<sub>2</sub>:181"><span class="id" title="variable">pc<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c:182"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">pc<sub>1</sub></span> <span class="id" title="var">pc<sub>2</sub></span> <span class="id" title="var">c</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">pc<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">pc<sub>2</sub></span> <span class="id" title="var">Hcan_flow</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_l"><span class="id" title="lemma">can_flow_join_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_1"><span class="id" title="lemma">can_flow_join_1</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#can_flow_trans"><span class="id" title="lemma">can_flow_trans</span></a>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_2"><span class="id" title="lemma">can_flow_join_2</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>0</sub></span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHwell_typed1</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_l"><span class="id" title="lemma">can_flow_join_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_r<sub>1</sub>"><span class="id" title="lemma">can_flow_join_r<sub>1</sub></span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_r<sub>2</sub>"><span class="id" title="lemma">can_flow_join_r<sub>2</sub></span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_refl"><span class="id" title="lemma">can_flow_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHwell_typed2</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_l"><span class="id" title="lemma">can_flow_join_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_r<sub>1</sub>"><span class="id" title="lemma">can_flow_join_r<sub>1</sub></span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_r<sub>2</sub>"><span class="id" title="lemma">can_flow_join_r<sub>2</sub></span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_refl"><span class="id" title="lemma">can_flow_refl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHwell_typed</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_l"><span class="id" title="lemma">can_flow_join_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_r<sub>1</sub>"><span class="id" title="lemma">can_flow_join_r<sub>1</sub></span></a>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_join_r<sub>2</sub>"><span class="id" title="lemma">can_flow_join_r<sub>2</sub></span></a>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_refl"><span class="id" title="lemma">can_flow_refl</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab41"></a><h2 class="section">Dealing with unsynchronized executions running different code</h2>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="var">different_code</span></span> corollary below is crucial for proving that
    the type system above still enforces noninterference even if it
    allows branching on secrets, and its proof follows easily from the
    following basic lemma: 
</div>
<div class="code">

<span class="id" title="keyword">Lemma</span> <a id="secret_run" class="idref" href="#secret_run"><span class="id" title="lemma">secret_run</span></a> : <span class="id" title="keyword">∀</span> {<a id="P:183" class="idref" href="#P:183"><span class="id" title="binder">P</span></a> <a id="c:184" class="idref" href="#c:184"><span class="id" title="binder">c</span></a> <a id="s:185" class="idref" href="#s:185"><span class="id" title="binder">s</span></a> <a id="s':186" class="idref" href="#s':186"><span class="id" title="binder">s'</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:183"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c:184"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s:185"><span class="id" title="variable">s</span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:184"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s':186"><span class="id" title="variable">s'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:183"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s:185"><span class="id" title="variable">s</span></a> <a class="idref" href="StaticIFC.html#s':186"><span class="id" title="variable">s'</span></a>.<br/>
<div class="togglescript" id="proofcontrol15" onclick="toggleDisplay('proof15');toggleDisplay('proofcontrol15')"><span class="show"></span></div>
<div class="proofscript" id="proof15" onclick="toggleDisplay('proof15');toggleDisplay('proofcontrol15')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">s</span> <span class="id" title="var">s'</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Heval</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">Heval</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hwt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <a class="idref" href="StaticIFC.html#pub_equiv_trans"><span class="id" title="lemma">pub_equiv_trans</span></a>, <a class="idref" href="StaticIFC.html#pub_equiv_refl"><span class="id" title="lemma">pub_equiv_refl</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;assignment&nbsp;case:&nbsp;crucial&nbsp;for&nbsp;preventing&nbsp;implicit&nbsp;flows&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">Hy</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#eqb_spec"><span class="id" title="lemma">String.eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hxy</span> | <span class="id" title="var">Hxy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="comment">(*&nbsp;assigned&nbsp;variable&nbsp;being&nbsp;public&nbsp;leads&nbsp;to&nbsp;contradiction:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;system&nbsp;prevents&nbsp;public&nbsp;variables&nbsp;from&nbsp;being&nbsp;assigned&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <a class="idref" href="StaticIFC.html#join_secret_l"><span class="id" title="lemma">join_secret_l</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>4</sub></span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hy</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>4</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>4</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="axiom">t_update_neq</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<br/>
<span class="id" title="keyword">Corollary</span> <a id="different_code" class="idref" href="#different_code"><span class="id" title="lemma">different_code</span></a> : <span class="id" title="keyword">∀</span> <a id="P:187" class="idref" href="#P:187"><span class="id" title="binder">P</span></a> <a id="c<sub>1</sub>:188" class="idref" href="#c<sub>1</sub>:188"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:189" class="idref" href="#c<sub>2</sub>:189"><span class="id" title="binder">c<sub>2</sub></span></a> <a id="s<sub>1</sub>:190" class="idref" href="#s<sub>1</sub>:190"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:191" class="idref" href="#s<sub>2</sub>:191"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>1</sub>':192" class="idref" href="#s<sub>1</sub>':192"><span class="id" title="binder">s<sub>1</sub>'</span></a> <a id="s<sub>2</sub>':193" class="idref" href="#s<sub>2</sub>':193"><span class="id" title="binder">s<sub>2</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:187"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:188"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:187"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:189"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:187"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:190"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:191"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s<sub>1</sub>:190"><span class="id" title="variable">s<sub>1</sub></span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:188"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s<sub>1</sub>':192"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s<sub>2</sub>:191"><span class="id" title="variable">s<sub>2</sub></span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:189"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s<sub>2</sub>':193"><span class="id" title="variable">s<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:187"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>':192"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>':193"><span class="id" title="variable">s<sub>2</sub>'</span></a>.<br/>
<div class="togglescript" id="proofcontrol16" onclick="toggleDisplay('proof16');toggleDisplay('proofcontrol16')"><span class="show"></span></div>
<div class="proofscript" id="proof16" onclick="toggleDisplay('proof16');toggleDisplay('proofcontrol16')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c<sub>1</sub></span> <span class="id" title="var">c<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">Hwt1</span> <span class="id" title="var">Hwt2</span> <span class="id" title="var">Hequiv</span> <span class="id" title="var">Heval1</span> <span class="id" title="var">Heval2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#secret_run"><span class="id" title="lemma">secret_run</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hwt1</span>; [| <span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#secret_run"><span class="id" title="lemma">secret_run</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hwt2</span>; [| <span class="id" title="var">eassumption</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#pub_equiv_sym"><span class="id" title="lemma">pub_equiv_sym</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Hwt1</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#pub_equiv_trans"><span class="id" title="lemma">pub_equiv_trans</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#pub_equiv_trans"><span class="id" title="lemma">pub_equiv_trans</span></a>; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab42"></a><h2 class="section">We show that <span class="inlinecode"><span class="id" title="var">well_typed</span></span> commands are <span class="inlinecode"><span class="id" title="var">noninterferent</span></span>.</h2>

</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="well_typed_noninterferent" class="idref" href="#well_typed_noninterferent"><span class="id" title="lemma">well_typed_noninterferent</span></a> : <span class="id" title="keyword">∀</span> <a id="P:194" class="idref" href="#P:194"><span class="id" title="binder">P</span></a> <a id="c:195" class="idref" href="#c:195"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:194"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c:195"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a> <a class="idref" href="StaticIFC.html#P:194"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#c:195"><span class="id" title="variable">c</span></a>.<br/>
<div class="togglescript" id="proofcontrol17" onclick="toggleDisplay('proof17');toggleDisplay('proofcontrol17')"><span class="show"></span></div>
<div class="proofscript" id="proof17" onclick="toggleDisplay('proof17');toggleDisplay('proofcontrol17')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">Heq</span> <span class="id" title="var">Heval1</span> <span class="id" title="var">Heval2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub>'</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Heval1</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">Heq</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">Heval2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Heval2</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hwt</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="StaticIFC.html#join_public_l"><span class="id" title="lemma">join_public_l</span></a> <span class="id" title="keyword">in</span> ×.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span> <span class="id" title="var">y</span> <span class="id" title="var">Hy</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#eqb_spec"><span class="id" title="lemma">String.eqb_spec</span></a> <span class="id" title="var">x</span> <span class="id" title="var">y</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Hxy</span> | <span class="id" title="var">Hxy</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hxy</span>. <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> <span class="id" title="axiom">t_update_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>9</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#orb_prop"><span class="id" title="lemma">orb_prop</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>9</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>9</sub></span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hl</span> | <span class="id" title="var">Hx</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hl</span> <span class="id" title="keyword">in</span> ×. <span class="id" title="tactic">apply</span> (<a class="idref" href="StaticIFC.html#noninterferent_aexp"><span class="id" title="lemma">noninterferent_aexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>8</sub></span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hy</span> <span class="id" title="keyword">in</span> <span class="id" title="var">Hx</span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">do</span> 2 <span class="id" title="tactic">rewrite</span> (<span class="id" title="axiom">t_update_neq</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hxy</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Heq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Hy</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1_2</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1_1</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;if&nbsp;true-true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#weaken_pc"><span class="id" title="lemma">weaken_pc</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_public"><span class="id" title="lemma">can_flow_public</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;if&nbsp;true-false&nbsp;*)</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>11</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>5</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>5</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#different_code"><span class="id" title="lemma">different_code</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">c<sub>1</sub></span>:=<span class="id" title="var">c<sub>1</sub></span>) (<span class="id" title="var">c<sub>2</sub></span>:=<span class="id" title="var">c<sub>2</sub></span>); <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;if&nbsp;false-true&nbsp;*)</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>11</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>5</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>5</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#different_code"><span class="id" title="lemma">different_code</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">c<sub>1</sub></span>:=<span class="id" title="var">c<sub>2</sub></span>) (<span class="id" title="var">c<sub>2</sub></span>:=<span class="id" title="var">c<sub>1</sub></span>); <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;if&nbsp;false-false&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#weaken_pc"><span class="id" title="lemma">weaken_pc</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_public"><span class="id" title="lemma">can_flow_public</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;while&nbsp;false-false&nbsp;*)</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;while&nbsp;false-true&nbsp;*)</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>10</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>2</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>2</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#different_code"><span class="id" title="lemma">different_code</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">c<sub>1</sub></span>:=<span class="id" title="notation">&lt;{</span><span class="id" title="notation">skip</span><span class="id" title="notation">}&gt;</span>) (<span class="id" title="var">c<sub>2</sub></span>:=<span class="id" title="notation">&lt;{</span><span class="id" title="var">c</span><span class="id" title="notation">;</span><span class="id" title="notation">while</span> <span class="id" title="var">b</span> <span class="id" title="notation">do</span> <span class="id" title="var">c</span> <span class="id" title="notation">end</span><span class="id" title="notation">}&gt;</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">econstructor</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;while&nbsp;true-false&nbsp;*)</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>8</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>4</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>4</sub></span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#different_code"><span class="id" title="lemma">different_code</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">c<sub>1</sub></span>:=<span class="id" title="notation">&lt;{</span><span class="id" title="var">c</span><span class="id" title="notation">;</span><span class="id" title="notation">while</span> <span class="id" title="var">b</span> <span class="id" title="notation">do</span> <span class="id" title="var">c</span> <span class="id" title="notation">end</span><span class="id" title="notation">}&gt;</span>) (<span class="id" title="var">c<sub>2</sub></span>:=<span class="id" title="notation">&lt;{</span><span class="id" title="notation">skip</span><span class="id" title="notation">}&gt;</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">econstructor</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;while&nbsp;true-true&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1_2</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1_1</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#weaken_pc"><span class="id" title="lemma">weaken_pc</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#can_flow_public"><span class="id" title="lemma">can_flow_public</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
The noninterference proof is still relatively simple, since the
    cases in which we take different branches based on secret
    information are all handled by the <span class="inlinecode"><span class="id" title="var">different_code</span></span> lemma.

<div class="paragraph"> </div>

    Another key ingredient for having a simple noninterference proof
    is working with a big-step semantics for Imp. 
<div class="paragraph"> </div>

<a id="lab43"></a><h1 class="section">Type system for termination-sensitive noninterference</h1>

<div class="paragraph"> </div>

 The noninterference notion we used above was "termination
    insensitive". If we prevent loop conditions depending on secrets
    we can actually enforce termination-sensitive noninterference
    (TSNI), which we defined in <a href="Noninterference.html"><span class="inlineref">Noninterference</span></a> as follows: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="tsni" class="idref" href="#tsni"><span class="id" title="definition">tsni</span></a> <a id="P:196" class="idref" href="#P:196"><span class="id" title="binder">P</span></a> <a id="c:197" class="idref" href="#c:197"><span class="id" title="binder">c</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:198" class="idref" href="#s<sub>1</sub>:198"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:199" class="idref" href="#s<sub>2</sub>:199"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>1</sub>':200" class="idref" href="#s<sub>1</sub>':200"><span class="id" title="binder">s<sub>1</sub>'</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s<sub>1</sub>:198"><span class="id" title="variable">s<sub>1</sub></span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:197"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s<sub>1</sub>':200"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:196"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:198"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:199"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>2</sub>':201" class="idref" href="#s<sub>2</sub>':201"><span class="id" title="binder">s<sub>2</sub>'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:199"><span class="id" title="variable">s<sub>2</sub></span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:197"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s<sub>2</sub>':201"><span class="id" title="variable">s<sub>2</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:196"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>':200"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>':201"><span class="id" title="variable">s<sub>2</sub>'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a>.<br/>
</div>

<div class="doc">
We could prove that <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> enforces TSNI, but that typing
    relation is too restrictive, since for TSNI we can allow
    if-then-else conditions to depend on secrets. So we define a new
    type system that only prevents <i>loop</i> conditions from depending on
    secrets. 
<div class="paragraph"> </div>

<a id="lab44"></a><h2 class="section">We just need to update the while rule of <span class="inlinecode"><span class="id" title="var">well_typed</span></span>:</h2>

<div class="paragraph"> </div>

 Old rule for noninterference:
<center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b &#x2208; l&nbsp;&nbsp;&nbsp;&nbsp;P ;; join pc l <span class="nowrap">&vert;--</span> c</td>
  <td class="infrulenamecol" rowspan="3">
    (WT_While) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P ;; pc <span class="nowrap">&vert;--</span> while b then c end</td>
  <td></td>
</tr>
</table></center>
<div class="paragraph"> </div>

    New rule for termination-sensitive noninterference:
<center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">P &#x22A2;b- b &#x2208; public&nbsp;&nbsp;&nbsp;&nbsp;P ;; public &#x22A2;ts- c</td>
  <td class="infrulenamecol" rowspan="3">
    (TS_While) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">P ;; public &#x22A2;ts- while b then c end</td>
  <td></td>
</tr>
</table></center>
<div class="paragraph"> </div>

   Beyond requiring the label of <span class="inlinecode"><span class="id" title="var">b</span></span> to be <span class="inlinecode"><span class="id" title="var">public</span></span>, this rule also
   requires that once one branches on secrets with if-then-else
   (i.e. pc=secret) no while loops are allowed.

</div>
<div class="code">

<span class="id" title="keyword">Reserved Notation</span> &quot;P ';;' pc '&#x22A2;ts-' c" (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Inductive</span> <a id="ts_well_typed" class="idref" href="#ts_well_typed"><span class="id" title="definition, inductive"><span id="ts_well_typed_ind" class="id"><span id="ts_well_typed_sind" class="id">ts_well_typed</span></span></span></a> (<a id="P:202" class="idref" href="#P:202"><span class="id" title="binder">P</span></a>:<a class="idref" href="StaticIFC.html#pub_vars"><span class="id" title="definition">pub_vars</span></a>) : <a class="idref" href="StaticIFC.html#label"><span class="id" title="definition">label</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="inductive">com</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="TS_Com" class="idref" href="#TS_Com"><span class="id" title="constructor">TS_Com</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:205" class="idref" href="#pc:205"><span class="id" title="binder">pc</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:205"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">skip</span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="TS_Asgn" class="idref" href="#TS_Asgn"><span class="id" title="constructor">TS_Asgn</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:206" class="idref" href="#pc:206"><span class="id" title="binder">pc</span></a> <a id="X:207" class="idref" href="#X:207"><span class="id" title="binder">X</span></a> <a id="a:208" class="idref" href="#a:208"><span class="id" title="binder">a</span></a> <a id="l:209" class="idref" href="#l:209"><span class="id" title="binder">l</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">a</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#a:208"><span class="id" title="variable">a</span></a> <a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#871b7a65833b6a11edb1ff2d625a2de<sub>2</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:209"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#can_flow"><span class="id" title="definition">can_flow</span></a> (<a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:206"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#l:209"><span class="id" title="variable">l</span></a>) (<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#X:207"><span class="id" title="variable">X</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:206"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#X:207"><span class="id" title="variable">X</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="StaticIFC.html#a:208"><span class="id" title="variable">a</span></a> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="TS_Seq" class="idref" href="#TS_Seq"><span class="id" title="constructor">TS_Seq</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:210" class="idref" href="#pc:210"><span class="id" title="binder">pc</span></a> <a id="c<sub>1</sub>:211" class="idref" href="#c<sub>1</sub>:211"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:212" class="idref" href="#c<sub>2</sub>:212"><span class="id" title="binder">c<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:210"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:211"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:210"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:212"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:210"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:211"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">;</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:212"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="TS_If" class="idref" href="#TS_If"><span class="id" title="constructor">TS_If</span></a> : <span class="id" title="keyword">∀</span> <a id="pc:213" class="idref" href="#pc:213"><span class="id" title="binder">pc</span></a> <a id="b:214" class="idref" href="#b:214"><span class="id" title="binder">b</span></a> <a id="l:215" class="idref" href="#l:215"><span class="id" title="binder">l</span></a> <a id="c<sub>1</sub>:216" class="idref" href="#c<sub>1</sub>:216"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:217" class="idref" href="#c<sub>2</sub>:217"><span class="id" title="binder">c<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:214"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#l:215"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:213"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#l:215"><span class="id" title="variable">l</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">)</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:216"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#join"><span class="id" title="definition">join</span></a> <a class="idref" href="StaticIFC.html#pc:213"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#l:215"><span class="id" title="variable">l</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">)</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:217"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:213"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">if</span> <a class="idref" href="StaticIFC.html#b:214"><span class="id" title="variable">b</span></a> <span class="id" title="notation">then</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:216"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">else</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:217"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span><br/>
&nbsp;&nbsp;| <a id="TS_While" class="idref" href="#TS_While"><span class="id" title="constructor">TS_While</span></a> : <span class="id" title="keyword">∀</span> <a id="b:218" class="idref" href="#b:218"><span class="id" title="binder">b</span></a> <a id="c<sub>1</sub>:219" class="idref" href="#c<sub>1</sub>:219"><span class="id" title="binder">c<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">b</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#b:218"><span class="id" title="variable">b</span></a> <a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">\</span></a><a class="idref" href="StaticIFC.html#42fedf909cd00a38e584747953581bd<sub>3</sub>"><span class="id" title="notation">in</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;&lt;--&nbsp;NEW&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:219"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="comment">(*&nbsp;&lt;--&nbsp;ONLY&nbsp;pc=public&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:202"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <span class="id" title="notation">&lt;{</span> <span class="id" title="notation">while</span> <a class="idref" href="StaticIFC.html#b:218"><span class="id" title="variable">b</span></a> <span class="id" title="notation">do</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:219"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">end</span> <span class="id" title="notation">}&gt;</span><br/>
<br/>
<span class="id" title="keyword">where</span> <a id="19786c1a041289c14b532d161e5dfab9" class="idref" href="#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&quot;</span></a>P ';;' pc '&#x22A2;ts-' c" := (<a class="idref" href="StaticIFC.html#ts_well_typed:204"><span class="id" title="inductive">ts_well_typed</span></a> <span class="id" title="var">P</span> <span class="id" title="var">pc</span> <span class="id" title="var">c</span>).<br/>
</div>

<div class="doc">
<a id="lab45"></a><h2 class="section">We prove that <span class="inlinecode"><span class="id" title="var">ts_well_typed</span></span> enforces TSNI.</h2>

<div class="paragraph"> </div>

 For this we show that <span class="inlinecode"><span class="id" title="var">ts_well_typed</span></span> implies <span class="inlinecode"><span class="id" title="var">well_typed</span></span>, so
    by our previous theorem also <span class="inlinecode"><span class="id" title="var">noninterference</span></span>.

<div class="paragraph"> </div>

    Then we show that <span class="inlinecode"><span class="id" title="var">P</span>;;</span> <span class="inlinecode"><span class="id" title="var">secret</span></span> <span class="inlinecode">&#x22A2;<span class="id" title="var">ts</span>-</span> <span class="inlinecode"><span class="id" title="var">c</span></span> implies termination.

<div class="paragraph"> </div>

    We use this to show that <span class="inlinecode"><span class="id" title="var">ts_well_typed</span></span> implies equitermination, which
    together with noninterference implies termination-sensitive noninterference.
 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="ts_well_typed_well_typed" class="idref" href="#ts_well_typed_well_typed"><span class="id" title="lemma">ts_well_typed_well_typed</span></a> : <span class="id" title="keyword">∀</span> <a id="P:220" class="idref" href="#P:220"><span class="id" title="binder">P</span></a> <a id="c:221" class="idref" href="#c:221"><span class="id" title="binder">c</span></a> <a id="pc:222" class="idref" href="#pc:222"><span class="id" title="binder">pc</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:220"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:222"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:221"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:220"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#pc:222"><span class="id" title="variable">pc</span></a> <a class="idref" href="StaticIFC.html#3431c6a3af34615c81a4e312b0fc6708"><span class="id" title="notation"><span class="nowrap">&vert;--</span></span></a> <a class="idref" href="StaticIFC.html#c:221"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">pc</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="ts_well_typed_noninterferent" class="idref" href="#ts_well_typed_noninterferent"><span class="id" title="lemma">ts_well_typed_noninterferent</span></a> : <span class="id" title="keyword">∀</span> <a id="P:223" class="idref" href="#P:223"><span class="id" title="binder">P</span></a> <a id="c:224" class="idref" href="#c:224"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:223"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:224"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#noninterferent"><span class="id" title="definition">noninterferent</span></a> <a class="idref" href="StaticIFC.html#P:223"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#c:224"><span class="id" title="variable">c</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#well_typed_noninterferent"><span class="id" title="lemma">well_typed_noninterferent</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="StaticIFC.html#ts_well_typed_well_typed"><span class="id" title="lemma">ts_well_typed_well_typed</span></a>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="ts_secret_run_terminating" class="idref" href="#ts_secret_run_terminating"><span class="id" title="lemma">ts_secret_run_terminating</span></a> : <span class="id" title="keyword">∀</span> {<a id="P:225" class="idref" href="#P:225"><span class="id" title="binder">P</span></a> <a id="c:226" class="idref" href="#c:226"><span class="id" title="binder">c</span></a> <a id="s:227" class="idref" href="#s:227"><span class="id" title="binder">s</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:225"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:226"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s':228" class="idref" href="#s':228"><span class="id" title="binder">s'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#s:227"><span class="id" title="variable">s</span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:226"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s':228"><span class="id" title="variable">s'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">s</span> <span class="id" title="var">Hwt</span>. <span class="id" title="var">remember</span> <a class="idref" href="StaticIFC.html#secret"><span class="id" title="definition">secret</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">Hwt</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">s</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">econstructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">econstructor</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHwt1</span> <span class="id" title="var">Heql</span> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span>  [<span class="id" title="var">s'</span> <span class="id" title="var">IH<sub>1</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHwt2</span> <span class="id" title="var">Heql</span> <span class="id" title="var">s'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s''IH<sub>2</sub></span>]. <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Heql</span> <span class="id" title="keyword">in</span> ×. <span class="id" title="tactic">rewrite</span> <a class="idref" href="StaticIFC.html#join_secret_l"><span class="id" title="lemma">join_secret_l</span></a> <span class="id" title="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHwt1</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">Logic.eq_refl</span></a> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">IH<sub>1</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHwt2</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">Logic.eq_refl</span></a> <span class="id" title="var">s</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">IH<sub>2</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">beval</span> <span class="id" title="var">s</span> <span class="id" title="var">b</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>; <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">discriminate</span> <span class="id" title="var">Heql</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="ts_well_typed_equitermination" class="idref" href="#ts_well_typed_equitermination"><span class="id" title="lemma">ts_well_typed_equitermination</span></a> : <span class="id" title="keyword">∀</span> {<a id="P:229" class="idref" href="#P:229"><span class="id" title="binder">P</span></a> <a id="c:230" class="idref" href="#c:230"><span class="id" title="binder">c</span></a> <a id="s<sub>1</sub>:231" class="idref" href="#s<sub>1</sub>:231"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:232" class="idref" href="#s<sub>2</sub>:232"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>1</sub>':233" class="idref" href="#s<sub>1</sub>':233"><span class="id" title="binder">s<sub>1</sub>'</span></a>},<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:229"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:230"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s<sub>1</sub>:231"><span class="id" title="variable">s<sub>1</sub></span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:230"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s<sub>1</sub>':233"><span class="id" title="variable">s<sub>1</sub>'</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:229"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:231"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:232"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">∃</span></a> <a id="s<sub>2</sub>':234" class="idref" href="#s<sub>2</sub>':234"><span class="id" title="binder">s<sub>2</sub>'</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:232"><span class="id" title="variable">s<sub>2</sub></span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:230"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#s<sub>2</sub>':234"><span class="id" title="variable">s<sub>2</sub>'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">C</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">Heval</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Heval</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hwt</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">econstructor</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHeval1</span> <span class="id" title="var">H<sub>2</sub></span> <span class="id" title="var">_</span> <span class="id" title="var">Heq</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">IH<sub>1</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Heq'</span> : <a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <span class="id" title="var">P</span> <span class="id" title="var">st'</span> <span class="id" title="var">s<sub>2</sub>'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#ts_well_typed_noninterferent"><span class="id" title="lemma">ts_well_typed_noninterferent</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="var">eassumption</span> | <span class="id" title="var">eassumption</span> | <span class="id" title="var">eassumption</span>]. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHeval2</span> <span class="id" title="var">H<sub>3</sub></span> <span class="id" title="var">_</span> <span class="id" title="var">Heq'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>''</span> <span class="id" title="var">IH<sub>2</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="StaticIFC.html#join_public_l"><span class="id" title="lemma">join_public_l</span></a> <span class="id" title="keyword">in</span> ×. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHeval</span> <span class="id" title="var">H<sub>5</sub></span> <span class="id" title="var">_</span> <span class="id" title="var">Heq</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">IH<sub>1</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <span class="id" title="constructor">E_IfTrue</span>; [ | <span class="id" title="var">eassumption</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Heq</span>; [ | <span class="id" title="var">eassumption</span> ]. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#ts_secret_run_terminating"><span class="id" title="lemma">ts_secret_run_terminating</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>5</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>5</sub></span> <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">H<sub>5</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#ts_secret_run_terminating"><span class="id" title="lemma">ts_secret_run_terminating</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>6</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>6</sub></span> <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">H<sub>6</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">beval</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">b</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq2</span>; <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <a class="idref" href="StaticIFC.html#join_public_l"><span class="id" title="lemma">join_public_l</span></a> <span class="id" title="keyword">in</span> ×. <span class="id" title="tactic">destruct</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHeval</span> <span class="id" title="var">H<sub>6</sub></span> <span class="id" title="var">_</span> <span class="id" title="var">Heq</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">IH<sub>1</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <span class="id" title="constructor">E_IfFalse</span>; [ | <span class="id" title="var">eassumption</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Heq</span>; [ | <span class="id" title="var">eassumption</span> ]. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#ts_secret_run_terminating"><span class="id" title="lemma">ts_secret_run_terminating</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>5</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>5</sub></span> <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">H<sub>5</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#ts_secret_run_terminating"><span class="id" title="lemma">ts_secret_run_terminating</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>6</sub></span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H<sub>6</sub></span> <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">H<sub>6</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">beval</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">b</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq2</span>; <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Heq</span>; [ | <span class="id" title="var">eassumption</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">apply</span> <span class="id" title="constructor">E_WhileFalse</span>. <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHeval1</span> <span class="id" title="var">H<sub>3</sub></span> <span class="id" title="var">_</span> <span class="id" title="var">Heq</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">IH<sub>1</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Heq'</span> : <a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <span class="id" title="var">P</span> <span class="id" title="var">st'</span> <span class="id" title="var">s<sub>2</sub>'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#ts_well_typed_noninterferent"><span class="id" title="lemma">ts_well_typed_noninterferent</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="var">eassumption</span> | <span class="id" title="var">eassumption</span> | <span class="id" title="var">eassumption</span>]. <span class="id" title="tactic">assumption</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHHeval2</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">_</span> <span class="id" title="var">Heq'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>''</span> <span class="id" title="var">IH<sub>2</sub></span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="keyword">in</span> <span class="id" title="var">Heq</span>; [ | <span class="id" title="var">eassumption</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">E_WhileTrue</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Corollary</span> <a id="ts_well_typed_tsni" class="idref" href="#ts_well_typed_tsni"><span class="id" title="lemma">ts_well_typed_tsni</span></a> : <span class="id" title="keyword">∀</span> <a id="P:235" class="idref" href="#P:235"><span class="id" title="binder">P</span></a> <a id="c:236" class="idref" href="#c:236"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:235"><span class="id" title="variable">P</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">;;</span></a> <a class="idref" href="StaticIFC.html#public"><span class="id" title="definition">public</span></a> <a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">ts</span></a><a class="idref" href="StaticIFC.html#19786c1a041289c14b532d161e5dfab9"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:236"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#tsni"><span class="id" title="definition">tsni</span></a> <a class="idref" href="StaticIFC.html#P:235"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#c:236"><span class="id" title="variable">c</span></a>.<br/>
<div class="togglescript" id="proofcontrol18" onclick="toggleDisplay('proof18');toggleDisplay('proofcontrol18')"><span class="show"></span></div>
<div class="proofscript" id="proof18" onclick="toggleDisplay('proof18');toggleDisplay('proofcontrol18')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">Heval1</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="StaticIFC.html#ts_well_typed_equitermination"><span class="id" title="lemma">ts_well_typed_equitermination</span></a> <span class="id" title="var">Hwt</span> <span class="id" title="var">Heval1</span> <span class="id" title="var">Heq</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">Heval2</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">∃</span> <span class="id" title="var">s<sub>2</sub>'</span>. <span class="id" title="tactic">split</span>; [<span class="id" title="tactic">assumption</span>| ].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#ts_well_typed_noninterferent"><span class="id" title="lemma">ts_well_typed_noninterferent</span></a>; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
<a id="lab46"></a><h1 class="section">Program counter security</h1>

<div class="paragraph"> </div>

 Especially for cryptographic code one is also worried about
    side-channel attacks, in which secrets are for instance leaked via
    the execution time of the program. For instance, most processors
    have instruction caches, which make executing cached instructions
    faster than non-cached ones.

<div class="paragraph"> </div>

    To prevent such attacks, cryptographic code is normally written
    without branching on any secrets. To formalize this we introduce a
    new security notion called <i>program counter security</i>, which
    considers the program's branching visible to the attacker. More
    precisely, we instrument the operational semantics of <span class="inlinecode"><span class="id" title="var">Imp</span></span> to
    also record the control-flow decisions of the program. 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="branches" class="idref" href="#branches"><span class="id" title="definition">branches</span></a> := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
</div>

<div class="doc">
<a id="lab47"></a><h2 class="section">Instrumented semantics with branches</h2>

<div class="paragraph"> </div>

<center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">&nbsp;&nbsp;</td>
  <td class="infrulenamecol" rowspan="3">
    (E_Skip) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">st =[ skip ]=> st, []</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">aeval st a = n</td>
  <td class="infrulenamecol" rowspan="3">
    (E_Asgn) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">st =[ x := a ]=> (x !<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span> n ; st), []</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">st  =[ c<sub>1</sub> ]=> st', bs<sub>1</sub>&nbsp;&nbsp;&nbsp;st' =[ c<sub>2</sub> ]=> st'', bs<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (E_Seq) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">st =[ c<sub>1</sub>;c<sub>2</sub> ]=> st'', (bs<sub>1</sub>++bs<sub>2</sub>)</td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">beval st b = true&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;st =[ c<sub>1</sub> ]=> st', bs<sub>1</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (E_IfTrue) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">st =[ if b then c<sub>1</sub> else c<sub>2</sub> end ]=> st', true::bs<sub>1</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">beval st b = false&nbsp;&nbsp;&nbsp;&nbsp;st =[ c<sub>2</sub> ]=> st', bs<sub>2</sub></td>
  <td class="infrulenamecol" rowspan="3">
    (E_IfFalse) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">st =[ if b then c<sub>1</sub> else c<sub>2</sub> end ]=> st', false::bs<sub>2</sub></td>
  <td></td>
</tr>
</table></center><center><table class="infrule">
<tr class="infruleassumption">
  <td class="infrule">st =[ if b then c; while b do c end else skip end ]=> st, os</td>
  <td class="infrulenamecol" rowspan="3">
    (E_While) &nbsp;
  </td></tr>
<tr class="infrulemiddle">
  <td class="infrule"><hr /></td>
</tr>
<tr class="infruleassumption">
  <td class="infrule">st =[ while b do c end ]=> st, os</td>
  <td></td>
</tr>
</table></center>
</div>
<div class="code">

<span class="id" title="keyword">Reserved Notation</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"st '=[' c ']=&gt;' st' , bs"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="var">c</span> <span class="id" title="var">custom</span> <span class="id" title="var">com</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">st</span> <span class="id" title="keyword">constr</span>, <span class="id" title="var">st'</span> <span class="id" title="keyword">constr</span> <span class="id" title="tactic">at</span> <span class="id" title="var">next</span> <span class="id" title="keyword">level</span>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Inductive</span> <a id="pceval" class="idref" href="#pceval"><span class="id" title="definition, inductive"><span id="pceval_ind" class="id"><span id="pceval_sind" class="id">pceval</span></span></span></a> : <span class="id" title="inductive">com</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="definition">state</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="definition">state</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="StaticIFC.html#branches"><span class="id" title="definition">branches</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a id="E_Skip" class="idref" href="#E_Skip"><span class="id" title="constructor">E_Skip</span></a> : <span class="id" title="keyword">∀</span> <a id="st:239" class="idref" href="#st:239"><span class="id" title="binder">st</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:239"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <span class="id" title="notation">skip</span> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st:239"><span class="id" title="variable">st</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <a id="E_Asgn" class="idref" href="#E_Asgn"><span class="id" title="constructor">E_Asgn</span></a>  : <span class="id" title="keyword">∀</span> <a id="st:240" class="idref" href="#st:240"><span class="id" title="binder">st</span></a> <a id="a:241" class="idref" href="#a:241"><span class="id" title="binder">a</span></a> <a id="n:242" class="idref" href="#n:242"><span class="id" title="binder">n</span></a> <a id="x:243" class="idref" href="#x:243"><span class="id" title="binder">x</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">aeval</span> <a class="idref" href="StaticIFC.html#st:240"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#a:241"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#n:242"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:240"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#x:243"><span class="id" title="variable">x</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="StaticIFC.html#a:241"><span class="id" title="variable">a</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#x:243"><span class="id" title="variable">x</span></a> <span class="id" title="notation">!<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span></span> <a class="idref" href="StaticIFC.html#n:242"><span class="id" title="variable">n</span></a> <span class="id" title="notation">;</span> <a class="idref" href="StaticIFC.html#st:240"><span class="id" title="variable">st</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><br/>
&nbsp;&nbsp;| <a id="E_Seq" class="idref" href="#E_Seq"><span class="id" title="constructor">E_Seq</span></a> : <span class="id" title="keyword">∀</span> <a id="c<sub>1</sub>:244" class="idref" href="#c<sub>1</sub>:244"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:245" class="idref" href="#c<sub>2</sub>:245"><span class="id" title="binder">c<sub>2</sub></span></a> <a id="st:246" class="idref" href="#st:246"><span class="id" title="binder">st</span></a> <a id="st':247" class="idref" href="#st':247"><span class="id" title="binder">st'</span></a> <a id="st'':248" class="idref" href="#st'':248"><span class="id" title="binder">st''</span></a> <a id="bs<sub>1</sub>:249" class="idref" href="#bs<sub>1</sub>:249"><span class="id" title="binder">bs<sub>1</sub></span></a> <a id="bs<sub>2</sub>:250" class="idref" href="#bs<sub>2</sub>:250"><span class="id" title="binder">bs<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:246"><span class="id" title="variable">st</span></a>  <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:244"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st':247"><span class="id" title="variable">st'</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#bs<sub>1</sub>:249"><span class="id" title="variable">bs<sub>1</sub></span></a>  <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st':247"><span class="id" title="variable">st'</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:245"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st'':248"><span class="id" title="variable">st''</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#bs<sub>2</sub>:250"><span class="id" title="variable">bs<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:246"><span class="id" title="variable">st</span></a>  <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:244"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">;</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:245"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st'':248"><span class="id" title="variable">st''</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">(</span></a><a class="idref" href="StaticIFC.html#bs<sub>1</sub>:249"><span class="id" title="variable">bs<sub>1</sub></span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a><a class="idref" href="StaticIFC.html#bs<sub>2</sub>:250"><span class="id" title="variable">bs<sub>2</sub></span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="E_IfTrue" class="idref" href="#E_IfTrue"><span class="id" title="constructor">E_IfTrue</span></a> : <span class="id" title="keyword">∀</span> <a id="st:251" class="idref" href="#st:251"><span class="id" title="binder">st</span></a> <a id="st':252" class="idref" href="#st':252"><span class="id" title="binder">st'</span></a> <a id="b:253" class="idref" href="#b:253"><span class="id" title="binder">b</span></a> <a id="c<sub>1</sub>:254" class="idref" href="#c<sub>1</sub>:254"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:255" class="idref" href="#c<sub>2</sub>:255"><span class="id" title="binder">c<sub>2</sub></span></a> <a id="bs<sub>1</sub>:256" class="idref" href="#bs<sub>1</sub>:256"><span class="id" title="binder">bs<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">beval</span> <a class="idref" href="StaticIFC.html#st:251"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#b:253"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">true</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:251"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:254"><span class="id" title="variable">c<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st':252"><span class="id" title="variable">st'</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#bs<sub>1</sub>:256"><span class="id" title="variable">bs<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:251"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <span class="id" title="notation">if</span> <a class="idref" href="StaticIFC.html#b:253"><span class="id" title="variable">b</span></a> <span class="id" title="notation">then</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:254"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">else</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:255"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">end</span><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st':252"><span class="id" title="variable">st'</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">(</span></a><span class="id" title="notation">true</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="StaticIFC.html#bs<sub>1</sub>:256"><span class="id" title="variable">bs<sub>1</sub></span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="E_IfFalse" class="idref" href="#E_IfFalse"><span class="id" title="constructor">E_IfFalse</span></a> : <span class="id" title="keyword">∀</span> <a id="st:257" class="idref" href="#st:257"><span class="id" title="binder">st</span></a> <a id="st':258" class="idref" href="#st':258"><span class="id" title="binder">st'</span></a> <a id="b:259" class="idref" href="#b:259"><span class="id" title="binder">b</span></a> <a id="c<sub>1</sub>:260" class="idref" href="#c<sub>1</sub>:260"><span class="id" title="binder">c<sub>1</sub></span></a> <a id="c<sub>2</sub>:261" class="idref" href="#c<sub>2</sub>:261"><span class="id" title="binder">c<sub>2</sub></span></a> <a id="bs<sub>1</sub>:262" class="idref" href="#bs<sub>1</sub>:262"><span class="id" title="binder">bs<sub>1</sub></span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">beval</span> <a class="idref" href="StaticIFC.html#st:257"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#b:259"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">false</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:257"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:261"><span class="id" title="variable">c<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st':258"><span class="id" title="variable">st'</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#bs<sub>1</sub>:262"><span class="id" title="variable">bs<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:257"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <span class="id" title="notation">if</span> <a class="idref" href="StaticIFC.html#b:259"><span class="id" title="variable">b</span></a> <span class="id" title="notation">then</span> <a class="idref" href="StaticIFC.html#c<sub>1</sub>:260"><span class="id" title="variable">c<sub>1</sub></span></a> <span class="id" title="notation">else</span> <a class="idref" href="StaticIFC.html#c<sub>2</sub>:261"><span class="id" title="variable">c<sub>2</sub></span></a> <span class="id" title="notation">end</span><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st':258"><span class="id" title="variable">st'</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">(</span></a><span class="id" title="notation">false</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a><a class="idref" href="StaticIFC.html#bs<sub>1</sub>:262"><span class="id" title="variable">bs<sub>1</sub></span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;| <a id="E_While" class="idref" href="#E_While"><span class="id" title="constructor">E_While</span></a> : <span class="id" title="keyword">∀</span> <a id="b:263" class="idref" href="#b:263"><span class="id" title="binder">b</span></a> <a id="st:264" class="idref" href="#st:264"><span class="id" title="binder">st</span></a> <a id="os:265" class="idref" href="#os:265"><span class="id" title="binder">os</span></a> <a id="c:266" class="idref" href="#c:266"><span class="id" title="binder">c</span></a>, <span class="comment">(*&nbsp;&lt;-&nbsp;Nice&nbsp;trick;&nbsp;from&nbsp;small-step&nbsp;semantics&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:264"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <span class="id" title="notation">if</span> <a class="idref" href="StaticIFC.html#b:263"><span class="id" title="variable">b</span></a> <span class="id" title="notation">then</span> <a class="idref" href="StaticIFC.html#c:266"><span class="id" title="variable">c</span></a><span class="id" title="notation">;</span> <span class="id" title="notation">while</span> <a class="idref" href="StaticIFC.html#b:263"><span class="id" title="variable">b</span></a> <span class="id" title="notation">do</span> <a class="idref" href="StaticIFC.html#c:266"><span class="id" title="variable">c</span></a> <span class="id" title="notation">end</span> <span class="id" title="notation">else</span> <span class="id" title="notation">skip</span> <span class="id" title="notation">end</span> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st:264"><span class="id" title="variable">st</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#os:265"><span class="id" title="variable">os</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:264"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <span class="id" title="notation">while</span> <a class="idref" href="StaticIFC.html#b:263"><span class="id" title="variable">b</span></a> <span class="id" title="notation">do</span> <a class="idref" href="StaticIFC.html#c:266"><span class="id" title="variable">c</span></a> <span class="id" title="notation">end</span> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st:264"><span class="id" title="variable">st</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#os:265"><span class="id" title="variable">os</span></a><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> <a id="864f078d3b8a045faf96060a4b46e834" class="idref" href="#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">&quot;</span></a>st =[ c ]=&gt; st' , bs" := (<a class="idref" href="StaticIFC.html#pceval:238"><span class="id" title="inductive">pceval</span></a> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">bs</span>).<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="pceval_ceval" class="idref" href="#pceval_ceval"><span class="id" title="lemma">pceval_ceval</span></a> : <span class="id" title="keyword">∀</span> <a id="c:267" class="idref" href="#c:267"><span class="id" title="binder">c</span></a> <a id="st:268" class="idref" href="#st:268"><span class="id" title="binder">st</span></a> <a id="st':269" class="idref" href="#st':269"><span class="id" title="binder">st'</span></a> <a id="bs:270" class="idref" href="#bs:270"><span class="id" title="binder">bs</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:268"><span class="id" title="variable">st</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#c:267"><span class="id" title="variable">c</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#st':269"><span class="id" title="variable">st'</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#bs:270"><span class="id" title="variable">bs</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#st:268"><span class="id" title="variable">st</span></a> <span class="id" title="notation">=[</span> <a class="idref" href="StaticIFC.html#c:267"><span class="id" title="variable">c</span></a> <span class="id" title="notation">]=&gt;</span> <a class="idref" href="StaticIFC.html#st':269"><span class="id" title="variable">st'</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">c</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">bs</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">induction</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">econstructor</span>; <span class="id" title="var">eassumption</span>).<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;need&nbsp;to&nbsp;justify&nbsp;the&nbsp;while&nbsp;trick&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">IHpceval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">inversion</span> <span class="id" title="var">H<sub>6</sub></span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">E_WhileTrue</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="constructor">E_WhileFalse</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab48"></a><h2 class="section">Program counter security definition</h2>

<div class="paragraph"> </div>

 Using the instrumented semantics we define program counter security: 
</div>
<div class="code">

<span class="id" title="keyword">Definition</span> <a id="pc_secure" class="idref" href="#pc_secure"><span class="id" title="definition">pc_secure</span></a> <a id="P:271" class="idref" href="#P:271"><span class="id" title="binder">P</span></a> <a id="c:272" class="idref" href="#c:272"><span class="id" title="binder">c</span></a> := <span class="id" title="keyword">∀</span> <a id="s<sub>1</sub>:273" class="idref" href="#s<sub>1</sub>:273"><span class="id" title="binder">s<sub>1</sub></span></a> <a id="s<sub>2</sub>:274" class="idref" href="#s<sub>2</sub>:274"><span class="id" title="binder">s<sub>2</sub></span></a> <a id="s<sub>1</sub>':275" class="idref" href="#s<sub>1</sub>':275"><span class="id" title="binder">s<sub>1</sub>'</span></a> <a id="s<sub>2</sub>':276" class="idref" href="#s<sub>2</sub>':276"><span class="id" title="binder">s<sub>2</sub>'</span></a> <a id="bs<sub>1</sub>:277" class="idref" href="#bs<sub>1</sub>:277"><span class="id" title="binder">bs<sub>1</sub></span></a> <a id="bs<sub>2</sub>:278" class="idref" href="#bs<sub>2</sub>:278"><span class="id" title="binder">bs<sub>2</sub></span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pub_equiv"><span class="id" title="definition">pub_equiv</span></a> <a class="idref" href="StaticIFC.html#P:271"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>:273"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>:274"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s<sub>1</sub>:273"><span class="id" title="variable">s<sub>1</sub></span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#c:272"><span class="id" title="variable">c</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#s<sub>1</sub>':275"><span class="id" title="variable">s<sub>1</sub>'</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#bs<sub>1</sub>:277"><span class="id" title="variable">bs<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#s<sub>2</sub>:274"><span class="id" title="variable">s<sub>2</sub></span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">=[</span></a> <a class="idref" href="StaticIFC.html#c:272"><span class="id" title="variable">c</span></a> <a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">]=&gt;</span></a> <a class="idref" href="StaticIFC.html#s<sub>2</sub>':276"><span class="id" title="variable">s<sub>2</sub>'</span></a><a class="idref" href="StaticIFC.html#864f078d3b8a045faf96060a4b46e834"><span class="id" title="notation">,</span></a> <a class="idref" href="StaticIFC.html#bs<sub>2</sub>:278"><span class="id" title="variable">bs<sub>2</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#bs<sub>1</sub>:277"><span class="id" title="variable">bs<sub>1</sub></span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="StaticIFC.html#bs<sub>2</sub>:278"><span class="id" title="variable">bs<sub>2</sub></span></a>.<br/>
</div>

<div class="doc">
Program counter security is mostly orthogonal to noninterference and
    instead of relating the final states it requires the branches of
    the program to be independent of secrets.

<div class="paragraph"> </div>

    Our restrictive <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> relation enforces both
    noninterference (as we already proved above) and program counter security: 
</div>
<div class="code">

<span class="id" title="keyword">Theorem</span> <a id="pc_well_typed_pc_secure" class="idref" href="#pc_well_typed_pc_secure"><span class="id" title="lemma">pc_well_typed_pc_secure</span></a> : <span class="id" title="keyword">∀</span> <a id="P:279" class="idref" href="#P:279"><span class="id" title="binder">P</span></a> <a id="c:280" class="idref" href="#c:280"><span class="id" title="binder">c</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#P:279"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">&#x22A2;</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">pc</span></a><a class="idref" href="StaticIFC.html#d14a14cbe43755d0c5387962d2da5148"><span class="id" title="notation">-</span></a> <a class="idref" href="StaticIFC.html#c:280"><span class="id" title="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="StaticIFC.html#pc_secure"><span class="id" title="definition">pc_secure</span></a> <a class="idref" href="StaticIFC.html#P:279"><span class="id" title="variable">P</span></a> <a class="idref" href="StaticIFC.html#c:280"><span class="id" title="variable">c</span></a>.<br/>
<div class="togglescript" id="proofcontrol19" onclick="toggleDisplay('proof19');toggleDisplay('proofcontrol19')"><span class="show"></span></div>
<div class="proofscript" id="proof19" onclick="toggleDisplay('proof19');toggleDisplay('proofcontrol19')">
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">P</span> <span class="id" title="var">c</span> <span class="id" title="var">Hwt</span> <span class="id" title="var">s<sub>1</sub></span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">s<sub>1</sub>'</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">bs<sub>1</sub></span> <span class="id" title="var">bs<sub>2</sub></span> <span class="id" title="var">Heq</span> <span class="id" title="var">Heval1</span> <span class="id" title="var">Heval2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub>'</span>. <span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">s<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> <span class="id" title="tactic">dependent</span> <span class="id" title="var">bs<sub>2</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">Heval1</span>; <span class="id" title="tactic">intros</span> <span class="id" title="var">bs<sub>2</sub>'</span> <span class="id" title="var">s<sub>2</sub></span> <span class="id" title="var">Heq</span> <span class="id" title="var">s<sub>2</sub>'</span> <span class="id" title="var">Heval2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">Heval2</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hwt</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">erewrite</span> <span class="id" title="var">IHHeval1_2</span>; [<span class="id" title="var">erewrite</span> <span class="id" title="var">IHHeval1_1</span> | | |];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;the&nbsp;proof&nbsp;does&nbsp;rely&nbsp;on&nbsp;noninterference&nbsp;for&nbsp;the&nbsp;sequencing&nbsp;case&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#pc_well_typed_noninterferent"><span class="id" title="lemma">pc_well_typed_noninterferent</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="var">eassumption</span> | <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#pceval_ceval"><span class="id" title="lemma">pceval_ceval</span></a>; <span class="id" title="var">eassumption</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">eapply</span> <a class="idref" href="StaticIFC.html#pceval_ceval"><span class="id" title="lemma">pceval_ceval</span></a>; <span class="id" title="var">eassumption</span> ]; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>11</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>6</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>6</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<a class="idref" href="StaticIFC.html#noninterferent_bexp"><span class="id" title="lemma">noninterferent_bexp</span></a> <span class="id" title="var">Heq</span> <span class="id" title="var">H<sub>11</sub></span>) <span class="id" title="keyword">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="keyword">in</span> <span class="id" title="var">H<sub>6</sub></span>. <span class="id" title="tactic">discriminate</span> <span class="id" title="var">H<sub>6</sub></span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1</span>; <span class="id" title="var">eassumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">IHHeval1</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">eassumption</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">constructor</span>; <span class="id" title="var">eassumption</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>
</div>

<div class="doc">
The proof does rely on <span class="inlinecode"><span class="id" title="var">pc_well_typed</span></span> implying noninterference
    for the sequencing case (and indirectly for the while case too,
    since in our semantics while evaluates to a sequence). 
</div>
<div class="code">

<span class="comment">(*&nbsp;2025-05-27&nbsp;12:16&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>